
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The goal of this project is to translate the wonderful resource http://e-maxx.ru/algo which provides descriptions of many algorithms and data structures especially popular in field of competitive programming. Moreover we want to improve the collected knowledge by extending the articles and adding new articles to the collection.">
      
      
      
        <link rel="canonical" href="https://cp-algorithms.com/algebra/continued-fractions.html">
      
      
        <link rel="prev" href="polynomial.html">
      
      
        <link rel="next" href="factoring-exp.html">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../feed_rss_updated.xml">
      
      <link rel="icon" href="../favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Continued fractions - Algorithms for Competitive Programming</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-7FLS2HCYHH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-7FLS2HCYHH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-7FLS2HCYHH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="cpalgo" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#continued-fractions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!-- overwrite:
- scroll to top when clicking title
- go to main page when clicking the site title
-->


<header class="md-header" data-md-component="header">
  <script>
    function scrollToTop() {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    }
  </script>
  <nav class="md-header__inner md-grid" aria-label="header.title">
    <a href=".." title="Algorithms for Competitive Programming" class="md-header__button md-logo" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
      
  <img src="../favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            <a href=".." title="Algorithms for Competitive Programming" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
              Algorithms for Competitive Programming
            </a>
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            <a href="#" onclick="scrollToTop()">
              
                Continued fractions
              
            </a>
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="cpalgo" data-md-color-primary="deep-purple" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/cp-algorithms/cp-algorithms" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    cp-algorithms/cp-algorithms
  </div>
</a>
      </div>
    
      <div class="rss icon">
      <a href="https://cp-algorithms.com/feed_rss_created.xml" title="RSS" class="md-content__button md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 64c0-17.7 14.3-32 32-32 229.8 0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7 0 64m0 352a64 64 0 1 1 128 0 64 64 0 1 1-128 0m32-256c159.1 0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7 0-32-14.3-32-32s14.3-32 32-32"/></svg>
      </a>
      </div>

    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Algorithms for Competitive Programming" class="md-nav__button md-logo" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
      
  <img src="../favicon.ico" alt="logo">

    </a>
    Algorithms for Competitive Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cp-algorithms/cp-algorithms" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    cp-algorithms/cp-algorithms
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Main Page
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../navigation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Navigation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tags.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tag index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contrib.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to Contribute
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code_of_conduct.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of conduct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Preview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Algebra
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Algebra
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="binary-exp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Binary Exponentiation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="euclid-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Euclidean algorithm for computing the greatest common divisor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="extended-euclid-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extended Euclidean Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linear-diophantine-equation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linear Diophantine Equations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="fibonacci-numbers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fibonacci Numbers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Prime numbers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Prime numbers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="sieve-of-eratosthenes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sieve of Eratosthenes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="prime-sieve-linear.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linear Sieve
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="primality_tests.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Primality tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="factorization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integer factorization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Number-theoretic functions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Number-theoretic functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="phi-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Euler's totient function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="divisors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Number of divisors / sum of divisors
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Modular arithmetic
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Modular arithmetic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="module-inverse.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modular Inverse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linear_congruence_equation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linear Congruence Equation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="chinese-remainder-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chinese Remainder Theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="garners-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Garner's Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="factorial-modulo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Factorial modulo p
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="discrete-log.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Discrete Log
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="primitive-root.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Primitive Root
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="discrete-root.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Discrete Root
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="montgomery_multiplication.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Montgomery Multiplication
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Number systems
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Number systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="balanced-ternary.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Balanced Ternary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gray-code.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gray code
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" checked>
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="bit-manipulation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bit manipulation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="all-submasks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enumerating submasks of a bitmask
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="big-integer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Arbitrary-Precision Arithmetic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="fft.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fast Fourier transform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="polynomial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operations on polynomials and series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Continued fractions
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="continued-fractions.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Continued fractions
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#continued-fraction-representation" class="md-nav__link">
    <span class="md-ellipsis">
      Continued fraction representation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Continued fraction representation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-results" class="md-nav__link">
    <span class="md-ellipsis">
      Key results
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergents" class="md-nav__link">
    <span class="md-ellipsis">
      Convergents
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Convergents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementation_1" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trees-of-continued-fractions" class="md-nav__link">
    <span class="md-ellipsis">
      Trees of continued fractions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trees of continued fractions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stern-brocot-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Stern-Brocot tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calkin-wilf-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Calkin-Wilf tree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linear-fractional-transformations" class="md-nav__link">
    <span class="md-ellipsis">
      Linear fractional transformations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geometric-interpretation" class="md-nav__link">
    <span class="md-ellipsis">
      Geometric interpretation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problem-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Problem examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practice-problems" class="md-nav__link">
    <span class="md-ellipsis">
      Practice problems
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="factoring-exp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Factoring Exponentiation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data Structures
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Data Structures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/stack_queue_modification.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimum Stack / Minimum Queue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sparse-table.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sparse Table
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Trees
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Trees
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/disjoint_set_union.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Disjoint Set Union
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/fenwick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fenwick Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sqrt_decomposition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sqrt Decomposition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/segment_tree.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Segment Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/treap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Treap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sqrt-tree.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sqrt Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/randomized_heap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Randomized Heap
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/deleting_in_log_n.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deleting from a data structure in O(T(n) log n)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Dynamic Programming
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Dynamic Programming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/intro-to-dp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Dynamic Programming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/knapsack.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knapsack Problem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    DP optimizations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            DP optimizations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/divide-and-conquer-dp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Divide and Conquer DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/knuth-optimization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knuth's Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/profile-dynamics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dynamic Programming on Broken Profile. Problem "Parquet"
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/zero_matrix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding the largest zero submatrix
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    String Processing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            String Processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/string-hashing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    String Hashing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/rabin-karp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rabin-Karp for String Matching
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/prefix-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prefix function - Knuth-Morris-Pratt
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/z-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Z-function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/suffix-array.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Suffix Array
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/aho_corasick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Aho-Corasick algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/suffix-tree-ukkonen.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Suffix Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/suffix-automaton.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Suffix Automaton
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/lyndon_factorization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lyndon factorization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/expression_parsing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Expression parsing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/manacher.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manacher's Algorithm - Finding all sub-palindromes in O(N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/main_lorentz.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding repetitions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linear Algebra
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Linear Algebra
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Matrices
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Matrices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/linear-system-gauss.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gauss & System of Linear Equations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/determinant-gauss.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gauss & Determinant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/determinant-kraut.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kraut & Determinant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/rank-matrix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rank of a matrix
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Combinatorics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Combinatorics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="factorial-divisors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Power of Factorial Divisor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/binomial-coefficients.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Binomial Coefficients
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/catalan-numbers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Catalan Numbers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Techniques
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Techniques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/inclusion-exclusion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Inclusion-Exclusion Principle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/burnside.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Burnside's lemma / Plya enumeration theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/stars_and_bars.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stars and bars
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/generating_combinations.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generating all K-combinations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/bishops-on-chessboard.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Placing Bishops on a Chessboard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/bracket_sequences.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Balanced bracket sequences
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/counting_labeled_graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Counting labeled graphs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Numerical Methods
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Numerical Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" >
        
          
          <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Search
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            Search
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/binary_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Binary Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/ternary_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ternary Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/roots_newton.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Newton's method for finding roots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/simulated_annealing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simulated Annealing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Integration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/simpson-integration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integration by Simpson's formula
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Geometry
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Geometry
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1" >
        
          
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Elementary operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            Elementary operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/basic-geometry.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Geometry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/segment-to-line.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding the equation of a line for a segment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/lines-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intersection Point of Lines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/check-segments-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Check if two segments intersect
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/segments-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intersection of Segments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/circle-line-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Circle-Line Intersection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/circle-circle-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Circle-Circle Intersection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/tangents-to-two-circles.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common tangents to two circles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/length-of-segments-union.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Length of the union of segments
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2" >
        
          
          <label class="md-nav__link" for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Polygons
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            Polygons
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/oriented-triangle-area.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Oriented area of a triangle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/area-of-simple-polygon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Area of simple polygon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/point-in-convex-polygon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Check if points belong to the convex polygon in O(log N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/minkowski.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minkowski sum of convex polygons
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/picks-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pick's Theorem - area of lattice polygons
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/lattice-points.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lattice points of non-lattice polygon
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Convex hull
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            Convex hull
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/convex-hull.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convex hull construction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/convex_hull_trick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convex hull trick and Li Chao tree
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_4" >
        
          
          <label class="md-nav__link" for="__nav_9_4" id="__nav_9_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sweep-line
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_4">
            <span class="md-nav__icon md-icon"></span>
            Sweep-line
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/intersecting_segments.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Search for a pair of intersecting segments
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_5" >
        
          
          <label class="md-nav__link" for="__nav_9_5" id="__nav_9_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Planar graphs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_5">
            <span class="md-nav__icon md-icon"></span>
            Planar graphs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/planar.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding faces of a planar graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/point-location.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Point location in O(log N)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_6" >
        
          
          <label class="md-nav__link" for="__nav_9_6" id="__nav_9_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_6">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/nearest_points.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding the nearest pair of points
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/delaunay.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Delaunay triangulation and Voronoi diagram
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/vertical_decomposition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vertical decomposition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/halfplane-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Half-plane intersection - S&I Algorithm in O(N log N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/manhattan-distance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manhattan Distance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Graphs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Graphs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_1" >
        
          
          <label class="md-nav__link" for="__nav_10_1" id="__nav_10_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Graph traversal
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_1">
            <span class="md-nav__icon md-icon"></span>
            Graph traversal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/breadth-first-search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Breadth First Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/depth-first-search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Depth First Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_2" >
        
          
          <label class="md-nav__link" for="__nav_10_2" id="__nav_10_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Connected components, bridges, articulations points
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_2">
            <span class="md-nav__icon md-icon"></span>
            Connected components, bridges, articulations points
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/search-for-connected-components.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Connected Components
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bridge-searching.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Bridges in O(N+M)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bridge-searching-online.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Bridges Online
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/cutpoints.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Articulation Points in O(N+M)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/strongly-connected-components.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strongly Connected Components and Condensation Graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/strong-orientation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strong Orientation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_3" >
        
          
          <label class="md-nav__link" for="__nav_10_3" id="__nav_10_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Single-source shortest paths
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_3">
            <span class="md-nav__icon md-icon"></span>
            Single-source shortest paths
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dijkstra.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dijkstra - finding shortest paths from given vertex
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dijkstra_sparse.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dijkstra on sparse graphs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bellman_ford.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bellman-Ford - finding shortest paths with negative weights
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/01_bfs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0-1 BFS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/desopo_pape.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DEsopo-Pape algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_4" >
        
          
          <label class="md-nav__link" for="__nav_10_4" id="__nav_10_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    All-pairs shortest paths
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_4">
            <span class="md-nav__icon md-icon"></span>
            All-pairs shortest paths
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/all-pair-shortest-path-floyd-warshall.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Floyd-Warshall - finding all shortest paths
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/fixed_length_paths.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Number of paths of fixed length / Shortest paths of fixed length
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_5" >
        
          
          <label class="md-nav__link" for="__nav_10_5" id="__nav_10_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Spanning trees
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_5">
            <span class="md-nav__icon md-icon"></span>
            Spanning trees
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_prim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimum Spanning Tree - Prim's Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_kruskal.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimum Spanning Tree - Kruskal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_kruskal_with_dsu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimum Spanning Tree - Kruskal with Disjoint Set Union
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/second_best_mst.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Second best Minimum Spanning Tree - Using Kruskal and Lowest Common Ancestor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/kirchhoff-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kirchhoff Theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/pruefer_code.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prfer code
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_6" >
        
          
          <label class="md-nav__link" for="__nav_10_6" id="__nav_10_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cycles
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_6">
            <span class="md-nav__icon md-icon"></span>
            Cycles
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/finding-cycle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Checking a graph for acyclicity and finding a cycle in O(M)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/finding-negative-cycle-in-graph.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding a Negative Cycle in the Graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/euler_path.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Eulerian Path
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_7" >
        
          
          <label class="md-nav__link" for="__nav_10_7" id="__nav_10_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Lowest common ancestor
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_7">
            <span class="md-nav__icon md-icon"></span>
            Lowest common ancestor
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lowest Common Ancestor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_binary_lifting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lowest Common Ancestor - Binary Lifting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_farachcoltonbender.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lowest Common Ancestor - Farach-Colton and Bender algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/rmq_linear.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solve RMQ by finding LCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_tarjan.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lowest Common Ancestor - Tarjan's off-line algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_8" >
        
          
          <label class="md-nav__link" for="__nav_10_8" id="__nav_10_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Flows and related problems
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_8">
            <span class="md-nav__icon md-icon"></span>
            Flows and related problems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/edmonds_karp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maximum flow - Ford-Fulkerson and Edmonds-Karp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/push-relabel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maximum flow - Push-relabel algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/push-relabel-faster.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maximum flow - Push-relabel algorithm improved
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dinic.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maximum flow - Dinic's algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mpm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maximum flow - MPM algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/flow_with_demands.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flows with demands
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/min_cost_flow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimum-cost flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/Assignment-problem-min-flow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment problem
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_9" >
        
          
          <label class="md-nav__link" for="__nav_10_9" id="__nav_10_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Matchings and related problems
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_9">
            <span class="md-nav__icon md-icon"></span>
            Matchings and related problems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bipartite-check.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bipartite Graph Check
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/kuhn_maximum_bipartite_matching.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kuhn's Algorithm - Maximum Bipartite Matching
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/hungarian-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hungarian Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_10" >
        
          
          <label class="md-nav__link" for="__nav_10_10" id="__nav_10_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_10">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/topological-sort.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Topological Sorting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/edge_vertex_connectivity.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Edge connectivity / Vertex connectivity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/tree_painting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tree painting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/2SAT.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2-SAT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/hld.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heavy-light decomposition
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1" >
        
          
          <label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sequences
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1">
            <span class="md-nav__icon md-icon"></span>
            Sequences
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/rmq.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RMQ task (Range Minimum Query - the smallest element in an interval)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/longest_increasing_subsequence.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Longest increasing subsequence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/maximum_average_segment.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Search the subsegment with the maximum/minimum sum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/k-th.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    K-th order statistic in O(N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/mex.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MEX task (Minimal Excluded element in an array)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Game Theory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            Game Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game_theory/games_on_graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Games on arbitrary graphs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game_theory/sprague-grundy-nim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sprague-Grundy theorem. Nim
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Schedules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            Schedules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule_one_machine.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scheduling jobs on one machine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule_two_machines.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scheduling jobs on two machines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule-with-completion-duration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimal schedule of jobs given their deadlines and durations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_4" >
        
          
          <label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_4">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/tortoise_and_hare.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tortoise and Hare Algorithm (Linked List cycle detection)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/josephus_problem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Josephus problem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/15-puzzle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15 Puzzle Game: Existence Of The Solution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/stern_brocot_tree_farey_sequences.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Stern-Brocot Tree and Farey Sequences
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  <script type="text/javascript">
window.onload = function() {
	const newIssueURL = "https://github.com/cp-algorithms/cp-algorithms/issues/new";
  const issueTitle = "Problem on article " + "Continued fractions";
	const issueBody = `
 **Article:** [`+ "Continued fractions" + `](${window.location.href})

**Problem:**
<!--
Describe the issue of this article in detail.
-->
`;
  var issue_a = document.getElementById("report_issue_a");
  issue_a.href = `${newIssueURL}?` + `title=${encodeURIComponent(issueTitle)}&` + `body=${encodeURIComponent(issueBody)}`;
}
</script>

<a href="https://github.com/cp-algorithms/cp-algorithms/edit/main/src/algebra/continued-fractions.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
</a>
<a id="report_issue_a" href="" title="Report a problem" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2z"/></svg>
</a>
<a href="https://github.com/cp-algorithms/cp-algorithms/commits/main/src/algebra/continued-fractions.md" title="Page authors" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g><g><path d="M12,8.5c-0.91,0-2.75,0.46-2.75,1.38v4.62h1.5V19h2.5v-4.5h1.5V9.88C14.75,8.97,12.91,8.5,12,8.5z"/><path d="M12,2C6.47,2,2,6.47,2,12s4.47,10,10,10s10-4.48,10-10S17.52,2,12,2z M12,20c-4.42,0-8-3.58-8-8s3.58-8,8-8s8,3.58,8,8 S16.42,20,12,20z"/><circle cx="12" cy="6.5" r="1.5"/></g></g></g></svg>
</a>


<!-- Construct the dict of author's contribution percentage -->




  
  
  
    
  
    
  

  
  
  
    
  

  
  
  
    
  
    
  
    
  

  
  
  
    
  



  
  
  

  
  
  

  
  
  




<!-- Date of last commit -->
<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">

  Last update:
  <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 16, 2023 07:02:44 UTC">October 16, 2023</span>&emsp;

<!-- Tags -->


  
    <a href="../tags.html#tag:original" class="md-tag">
      Original
    </a>
  

</ul>


<!--?title Continued fractions -->
<h1 id="continued-fractions">Continued fractions<a class="headerlink" href="#continued-fractions" title="Permanent link">&para;</a></h1>
<p><strong>Continued fraction</strong> is a representation of a real number as a specific convergent sequence of rational numbers. They are useful in competitive programming because they are easy to compute and can be efficiently used to find the best possible rational approximation of the underlying real number (among all numbers whose denominator doesn't exceed a given value).</p>
<p>Besides that, continued fractions are closely related to Euclidean algorithm which makes them useful in a bunch of number-theoretical problems.</p>
<h2 id="continued-fraction-representation">Continued fraction representation<a class="headerlink" href="#continued-fraction-representation" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Definition</p>
<p>Let <span class="arithmatex">$a_0, a_1, \dots, a_k \in \mathbb Z$</span> and <span class="arithmatex">$a_1, a_2, \dots, a_k \geq 1$</span>. Then the expression</p>
<div class="arithmatex">$$r=a_0 + \frac{1}{a_1 + \frac{1}{\dots + \frac{1}{a_k}}},$$</div>
<p>is called the <strong>continued fraction representation</strong> of the rational number <span class="arithmatex">$r$</span> and is denoted shortly as <span class="arithmatex">$r=[a_0;a_1,a_2,\dots,a_k]$</span>.</p>
</div>
<details class="example">
<summary>Example</summary>
<p>Let <span class="arithmatex">$r = \frac{5}{3}$</span>. There are two ways to represent it as a continued fraction:</p>
<div class="arithmatex">$$
\begin{align}
r = [1;1,1,1] &amp;= 1+\frac{1}{1+\frac{1}{1+\frac{1}{1}}},\\
r = [1;1,2] &amp;= 1+\frac{1}{1+\frac{1}{2}}.
\end{align}
$$</div>
</details>
<p>It can be proven that any rational number can be represented as a continued fraction in exactly <span class="arithmatex">$2$</span> ways:</p>
<div class="arithmatex">$$r = [a_0;a_1,\dots,a_k,1] = [a_0;a_1,\dots,a_k+1].$$</div>
<p>Moreover, the length <span class="arithmatex">$k$</span> of such continued fraction is estimated as <span class="arithmatex">$k = O(\log \min(p, q))$</span> for <span class="arithmatex">$r=\frac{p}{q}$</span>.</p>
<p>The reasoning behind this will be clear once we delve into the details of the continued fraction construction.</p>
<div class="admonition info">
<p class="admonition-title">Definition</p>
<p>Let <span class="arithmatex">$a_0,a_1,a_2, \dots$</span> be an integer sequence such that <span class="arithmatex">$a_1, a_2, \dots \geq 1$</span>. Let <span class="arithmatex">$r_k = [a_0; a_1, \dots, a_k]$</span>. Then the expression</p>
<div class="arithmatex">$$r = a_0 + \frac{1}{a_1 + \frac{1}{a_2+\dots}} = \lim\limits_{k \to \infty} r_k.$$</div>
<p>is called the <strong>continued fraction representation</strong> of the irrational number <span class="arithmatex">$r$</span> and is denoted shortly as <span class="arithmatex">$r = [a_0;a_1,a_2,\dots]$</span>.</p>
</div>
<p>Note that for <span class="arithmatex">$r=[a_0;a_1,\dots]$</span> and integer <span class="arithmatex">$k$</span>, it holds that <span class="arithmatex">$r+k = [a_0+k; a_1, \dots]$</span>.</p>
<p>Another important observation is that <span class="arithmatex">$\frac{1}{r}=[0;a_0, a_1, \dots]$</span> when <span class="arithmatex">$a_0 &gt; 0$</span> and <span class="arithmatex">$\frac{1}{r} = [a_1; a_2, \dots]$</span> when <span class="arithmatex">$a_0 = 0$</span>.</p>
<div class="admonition info">
<p class="admonition-title">Definition</p>
<p>In the definition above, rational numbers <span class="arithmatex">$r_0, r_1, r_2, \dots$</span> are called the <strong>convergents</strong> of <span class="arithmatex">$r$</span>.</p>
<p>Correspondingly, individual <span class="arithmatex">$r_k = [a_0; a_1, \dots, a_k] = \frac{p_k}{q_k}$</span> is called the <span class="arithmatex">$k$</span>-th <strong>convergent</strong> of <span class="arithmatex">$r$</span>.</p>
</div>
<details class="example">
<summary>Example</summary>
<p>Consider <span class="arithmatex">$r = [1; 1, 1, 1, \dots]$</span>. It can be proven by induction that <span class="arithmatex">$r_k = \frac{F_{k+2}}{F_{k+1}}$</span>, where <span class="arithmatex">$F_k$</span> is the Fibonacci sequence defined as <span class="arithmatex">$F_0 = 0$</span>, <span class="arithmatex">$F_1 = 1$</span> and <span class="arithmatex">$F_{k} = F_{k-1} + F_{k-2}$</span>. From the Binet's formula, it is known that</p>
<div class="arithmatex">$$r_k = \frac{\phi^{k+2} - \psi^{k+2}}{\phi^{k+1} - \psi^{k+1}},$$</div>
<p>where <span class="arithmatex">$\phi = \frac{1+\sqrt{5}}{2} \approx 1.618$</span> is the golden ratio and <span class="arithmatex">$\psi = \frac{1-\sqrt{5}}{2} = -\frac{1}{\phi} \approx -0.618$</span>. Thus,</p>
<div class="arithmatex">$$r = 1+\frac{1}{1+\frac{1}{1+\dots}}=\lim\limits_{k \to \infty} r_k = \phi = \frac{1+\sqrt{5}}{2}.$$</div>
<p>Note that in this specific case, an alternative way to find <span class="arithmatex">$r$</span> would be to solve the equation</p>
<div class="arithmatex">$$r = 1+\frac{1}{r} \implies r^2 = r + 1. $$</div>
</details>
<div class="admonition info">
<p class="admonition-title">Definition</p>
<p>Let <span class="arithmatex">$r_k = [a_0; a_1, \dots, a_{k-1}, a_k]$</span>. The numbers <span class="arithmatex">$[a_0; a_1, \dots, a_{k-1}, t]$</span> for <span class="arithmatex">$1 \leq t \leq a_k$</span> are called <strong>semiconvergents</strong>.</p>
<p>We will typically refer to (semi)convergents that are greater than <span class="arithmatex">$r$</span> as <strong>upper</strong> (semi)convergents and to those that are less than <span class="arithmatex">$r$</span> as <strong>lower</strong> (semi)convergents.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Definition</p>
<p>Complementary to convergents, we define the <strong><a href="https://en.wikipedia.org/wiki/Complete_quotient">complete quotients</a></strong> as <span class="arithmatex">$s_k = [a_k; a_{k+1}, a_{k+2}, \dots]$</span>.</p>
<p>Correspondingly, we will call an individual <span class="arithmatex">$s_k$</span> the <span class="arithmatex">$k$</span>-th complete quotient of <span class="arithmatex">$r$</span>.</p>
</div>
<p>From the definitions above, one can conclude that <span class="arithmatex">$s_k \geq 1$</span> for <span class="arithmatex">$k \geq 1$</span>.</p>
<p>Treating <span class="arithmatex">$[a_0; a_1, \dots, a_k]$</span> as a formal algebraic expression and allowing arbitrary real numbers instead of <span class="arithmatex">$a_i$</span>, we obtain</p>
<div class="arithmatex">$$r = [a_0; a_1, \dots, a_{k-1}, s_k].$$</div>
<p>In particular, <span class="arithmatex">$r = [s_0] = s_0$</span>. On the other hand, we can express <span class="arithmatex">$s_k$</span> as</p>
<div class="arithmatex">$$s_k = [a_k; s_{k+1}] = a_k + \frac{1}{s_{k+1}},$$</div>
<p>meaning that we can compute <span class="arithmatex">$a_k = \lfloor s_k \rfloor$</span> and <span class="arithmatex">$s_{k+1} = (s_k - a_k)^{-1}$</span> from <span class="arithmatex">$s_k$</span>.</p>
<p>The sequence <span class="arithmatex">$a_0, a_1, \dots$</span> is well-defined unless <span class="arithmatex">$s_k=a_k$</span> which only happens when <span class="arithmatex">$r$</span> is a rational number.</p>
<p>Thus the continued fraction representation is uniquely defined for any irrational number <span class="arithmatex">$r$</span>.</p>
<h3 id="implementation">Implementation<a class="headerlink" href="#implementation" title="Permanent link">&para;</a></h3>
<p>In the code snippets we will mostly assume finite continued fractions.</p>
<p>From <span class="arithmatex">$s_k$</span>, the transition to <span class="arithmatex">$s_{k+1}$</span> looks like</p>
<div class="arithmatex">$$s_k =\left\lfloor s_k \right\rfloor + \frac{1}{s_{k+1}}.$$</div>
<p>From this expression, the next complete quotient <span class="arithmatex">$s_{k+1}$</span> is obtained as</p>
<div class="arithmatex">$$s_{k+1} = \left(s_k-\left\lfloor s_k\right\rfloor\right)^{-1}.$$</div>
<p>For <span class="arithmatex">$s_k=\frac{p}{q}$</span> it means that</p>
<div class="arithmatex">$$
s_{k+1} = \left(\frac{p}{q}-\left\lfloor \frac{p}{q} \right\rfloor\right)^{-1} = \frac{q}{p-q\cdot \lfloor \frac{p}{q} \rfloor} = \frac{q}{p \bmod q}.
$$</div>
<p>Thus, the computation of a continued fraction representation for <span class="arithmatex">$r=\frac{p}{q}$</span> follows the steps of the Euclidean algorithm for <span class="arithmatex">$p$</span> and <span class="arithmatex">$q$</span>.</p>
<p>From this also follows that <span class="arithmatex">$\gcd(p_k, q_k) = 1$</span> for <span class="arithmatex">$\frac{p_k}{q_k} = [a_0; a_1, \dots, a_k]$</span>. Hence, convergents are always irreducible.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">C++</label><label for="__tabbed_1_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">auto</span><span class="w"> </span><span class="n">fraction</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">a</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>
<span class="w">        </span><span class="n">tie</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_pair</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fraction</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">//</span> <span class="n">q</span><span class="p">)</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="o">%</span> <span class="n">q</span>
    <span class="k">return</span> <span class="n">a</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="key-results">Key results<a class="headerlink" href="#key-results" title="Permanent link">&para;</a></h2>
<p>To provide some motivation for further study of continued fraction, we give some key facts now.</p>
<details class="note">
<summary>Recurrence</summary>
<p>For the convergents <span class="arithmatex">$r_k = \frac{p_k}{q_k}$</span>, the following recurrence stands, allowing their fast computation:</p>
<div class="arithmatex">$$\frac{p_k}{q_k}=\frac{a_k p_{k-1} + p_{k-2}}{a_k q_{k-1} + q_{k-2}},$$</div>
<p>where <span class="arithmatex">$\frac{p_{-1}}{q_{-1}}=\frac{1}{0}$</span> and <span class="arithmatex">$\frac{p_{-2}}{q_{-2}}=\frac{0}{1}$</span>.</p>
</details>
<details class="note">
<summary>Deviations</summary>
<p>The deviation of <span class="arithmatex">$r_k = \frac{p_k}{q_k}$</span> from <span class="arithmatex">$r$</span> can be generally estimated as</p>
<div class="arithmatex">$$\left|\frac{p_k}{q_k}-r\right| \leq \frac{1}{q_k q_{k+1}} \leq \frac{1}{q_k^2}.$$</div>
<p>Multiplying both sides with <span class="arithmatex">$q_k$</span>, we obtain alternate estimation:</p>
<div class="arithmatex">$$|p_k - q_k r| \leq \frac{1}{q_{k+1}}.$$</div>
<p>From the recurrence above it follows that <span class="arithmatex">$q_k$</span> grows at least as fast as Fibonacci numbers.</p>
<p>On the picture below you may see the visualization of how convergents <span class="arithmatex">$r_k$</span> approach <span class="arithmatex">$r=\frac{1+\sqrt 5}{2}$</span>:</p>
<p><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/b/b4/Golden_ration_convergents.svg" /></p>
<p><span class="arithmatex">$r=\frac{1+\sqrt 5}{2}$</span> is depicted by blue dotted line. Odd convergents approach it from above and even convergents approach it from below.</p>
</details>
<details class="note">
<summary>Lattice hulls</summary>
<p>Consider convex hulls of points above and below the line <span class="arithmatex">$y=rx$</span>.</p>
<p>Odd convergents <span class="arithmatex">$(q_k;p_k)$</span> are the vertices of the upper hull, while the even convergents <span class="arithmatex">$(q_k;p_k)$</span> are the vertices of the bottom hull.</p>
<p>All integers vertices on the hulls are obtained as <span class="arithmatex">$(q;p)$</span> such that</p>
<div class="arithmatex">$$\frac{p}{q} = \frac{tp_{k-1} + p_{k-2}}{tq_{k-1} + q_{k-2}}$$</div>
<p>for integer <span class="arithmatex">$0 \leq t \leq a_k$</span>. In other words, the set of lattice points on the hulls corresponds to the set of semiconvergents.</p>
<p>On the picture below, you may see the convergents and semiconvergents (intermediate gray points) of <span class="arithmatex">$r=\frac{9}{7}$</span>.</p>
<p><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/9/92/Continued_convergents_geometry.svg" /></p>
</details>
<details class="note">
<summary>Best approximations</summary>
<p>Let <span class="arithmatex">$\frac{p}{q}$</span> be the fraction to minimize <span class="arithmatex">$\left|r-\frac{p}{q}\right|$</span> subject to <span class="arithmatex">$q \leq x$</span> for some <span class="arithmatex">$x$</span>.</p>
<p>Then <span class="arithmatex">$\frac{p}{q}$</span> is a semiconvergent of <span class="arithmatex">$r$</span>.</p>
</details>
<p>The last fact allows to find the best rational approximations of <span class="arithmatex">$r$</span> by checking its semiconvergents.</p>
<p>Below you will find the further explanation and a bit of intuition and interpretation for these facts.</p>
<h2 id="convergents">Convergents<a class="headerlink" href="#convergents" title="Permanent link">&para;</a></h2>
<p>Let's take a closer look at the convergents that were defined earlier. For <span class="arithmatex">$r=[a_0, a_1, a_2, \dots]$</span>, its convergents are</p>
<div class="arithmatex">$$\begin{gather}
r_0=[a_0],\\r_1=[a_0, a_1],\\ \dots,\\ r_k=[a_0, a_1, \dots, a_k].
\end{gather}$$</div>
<p>Convergents are the core concept of continued fractions, so it is important to study their properties.</p>
<p>For the number <span class="arithmatex">$r$</span>, its <span class="arithmatex">$k$</span>-th convergent <span class="arithmatex">$r_k = \frac{p_k}{q_k}$</span> can be computed as</p>
<div class="arithmatex">$$r_k = \frac{P_k(a_0,a_1,\dots,a_k)}{P_{k-1}(a_1,\dots,a_k)} = \frac{a_k p_{k-1} + p_{k-2}}{a_k q_{k-1} + q_{k-2}},$$</div>
<p>where <span class="arithmatex">$P_k(a_0,\dots,a_k)$</span> is <a href="https://en.wikipedia.org/wiki/Continuant_(mathematics)">the continuant</a>, a multivariate polynomial defined as</p>
<div class="arithmatex">$$P_k(x_0,x_1,\dots,x_k) = \det \begin{bmatrix}
x_k &amp; 1 &amp; 0 &amp; \dots &amp; 0 \\
-1 &amp; x_{k-1} &amp; 1 &amp; \dots &amp; 0 \\
0 &amp; -1 &amp; x_2 &amp; . &amp; \vdots \\
\vdots &amp; \vdots &amp; . &amp; \ddots &amp; 1 \\
0 &amp; 0 &amp; \dots &amp; -1 &amp; x_0
\end{bmatrix}_{\textstyle .}$$</div>
<p>Thus, <span class="arithmatex">$r_k$</span> is a weighted <a href="https://en.wikipedia.org/wiki/Mediant_(mathematics)">mediant</a> of <span class="arithmatex">$r_{k-1}$</span> and <span class="arithmatex">$r_{k-2}$</span>.</p>
<p>For consistency, two additional convergents <span class="arithmatex">$r_{-1} = \frac{1}{0}$</span> and <span class="arithmatex">$r_{-2} = \frac{0}{1}$</span> are defined.</p>
<details class="hint">
<summary>Detailed explanation</summary>
<p>The numerator and the denominator of <span class="arithmatex">$r_k$</span> can be seen as multivariate polynomials of <span class="arithmatex">$a_0, a_1, \dots, a_k$</span>:</p>
<div class="arithmatex">$$r_k = \frac{P_k(a_0, a_1, \dots, a_k)}{Q_k(a_0,a_1, \dots, a_k)}.$$</div>
<p>From the definition of convergents,</p>
<div class="arithmatex">$$r_k = a_0 + \frac{1}{[a_1;a_2,\dots, a_k]}= a_0 + \frac{Q_{k-1}(a_1, \dots, a_k)}{P_{k-1}(a_1, \dots, a_k)} = \frac{a_0 P_{k-1}(a_1, \dots, a_k) + Q_{k-1}(a_1, \dots, a_k)}{P_{k-1}(a_1, \dots, a_k)}.$$</div>
<p>From this follows <span class="arithmatex">$Q_k(a_0, \dots, a_k) = P_{k-1}(a_1, \dots, a_k)$</span>. This yields the relation</p>
<div class="arithmatex">$$P_k(a_0, \dots, a_k) = a_0 P_{k-1}(a_1, \dots, a_k) + P_{k-2}(a_2, \dots, a_k).$$</div>
<p>Initially, <span class="arithmatex">$r_0 = \frac{a_0}{1}$</span> and <span class="arithmatex">$r_1 = \frac{a_0 a_1 + 1}{a_1}$</span>, thus</p>
<div class="arithmatex">$$\begin{align}P_0(a_0)&amp;=a_0,\\ P_1(a_0, a_1) &amp;= a_0 a_1 + 1.\end{align}$$</div>
<p>For consistency, it is convenient to define <span class="arithmatex">$P_{-1} = 1$</span> and <span class="arithmatex">$P_{-2}=0$</span> and formally say that <span class="arithmatex">$r_{-1} = \frac{1}{0}$</span> and <span class="arithmatex">$r_{-2}=\frac{0}{1}$</span>.</p>
<p>From numerical analysis, it is known that the determinant of an arbitrary tridiagonal matrix</p>
<div class="arithmatex">$$T_k = \det \begin{bmatrix}
a_0 &amp; b_0 &amp; 0 &amp; \dots &amp; 0 \\
c_0 &amp; a_1 &amp; b_1 &amp; \dots &amp; 0 \\
0 &amp; c_1 &amp; a_2 &amp; . &amp; \vdots \\
\vdots &amp; \vdots &amp; . &amp; \ddots &amp; c_{k-1} \\
0 &amp; 0 &amp; \dots &amp; b_{k-1} &amp; a_k
\end{bmatrix}$$</div>
<p>can be computed recursively as <span class="arithmatex">$T_k = a_k T_{k-1} - b_{k-1} c_{k-1} T_{k-2}$</span>. Comparing it to <span class="arithmatex">$P_k$</span>, we get a direct expression</p>
<div class="arithmatex">$$P_k = \det \begin{bmatrix}
x_k &amp; 1 &amp; 0 &amp; \dots &amp; 0 \\
-1 &amp; x_{k-1} &amp; 1 &amp; \dots &amp; 0 \\
0 &amp; -1 &amp; x_2 &amp; . &amp; \vdots \\
\vdots &amp; \vdots &amp; . &amp; \ddots &amp; 1 \\
0 &amp; 0 &amp; \dots &amp; -1 &amp; x_0
\end{bmatrix}_{\textstyle .}$$</div>
<p>This polynomial is also known as <a href="https://en.wikipedia.org/wiki/Continuant_(mathematics)">the continuant</a> due to its close relation with continued fraction. The continuant won't change if the sequence on the main diagonal is reversed. This yields an alternative formula to compute it:</p>
<div class="arithmatex">$$P_k(a_0, \dots, a_k) = a_k P_{k-1}(a_0, \dots, a_{k-1}) + P_{k-2}(a_0, \dots, a_{k-2}).$$</div>
</details>
<h3 id="implementation_1">Implementation<a class="headerlink" href="#implementation_1" title="Permanent link">&para;</a></h3>
<p>We will compute the convergents as a pair of sequences <span class="arithmatex">$p_{-2}, p_{-1}, p_0, p_1, \dots, p_k$</span> and <span class="arithmatex">$q_{-2}, q_{-1}, q_0, q_1, \dots, q_k$</span>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">C++</label><label for="__tabbed_2_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">auto</span><span class="w"> </span><span class="n">convergents</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">it</span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">p</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">p</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">]);</span>
<span class="w">        </span><span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">make_pair</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">q</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">it</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">it</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="trees-of-continued-fractions">Trees of continued fractions<a class="headerlink" href="#trees-of-continued-fractions" title="Permanent link">&para;</a></h2>
<p>There are two major ways to unite all possible continued fractions into useful tree structures.</p>
<h3 id="stern-brocot-tree">Stern-Brocot tree<a class="headerlink" href="#stern-brocot-tree" title="Permanent link">&para;</a></h3>
<p><a href="../others/stern_brocot_tree_farey_sequences.html">The Stern-Brocot tree</a> is a binary search tree that contains all distinct positive rational numbers.</p>
<p>The tree generally looks as follows:</p>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/3/37/SternBrocotTree.svg">
<figcaption>
<a href="https://commons.wikimedia.org/wiki/File:SternBrocotTree.svg">The image</a> by <a href="https://commons.wikimedia.org/wiki/User:Aaron_Rotenberg">Aaron Rotenberg</a> is licensed under <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en">CC BY-SA 3.0</a>
</figcaption>
</figure>

<p>Fractions <span class="arithmatex">$\frac{0}{1}$</span> and <span class="arithmatex">$\frac{1}{0}$</span> are "virtually" kept on the left and right sides of the tree correspondingly.</p>
<p>Then the fraction in a node is a mediant <span class="arithmatex">$\frac{a+c}{b+d}$</span> of two fractions <span class="arithmatex">$\frac{a}{b}$</span> and <span class="arithmatex">$\frac{c}{d}$</span> above it.</p>
<p>The recurrence <span class="arithmatex">$\frac{p_k}{q_k}=\frac{a_k p_{k-1} + p_{k-2}}{a_k q_{k-1} + q_{k-2}}$</span> means that the continued fraction representation encodes the path to <span class="arithmatex">$\frac{p_k}{q_k}$</span> in the tree. To find <span class="arithmatex">$[a_0; a_1, \dots, a_{k}, 1]$</span>, one has to make <span class="arithmatex">$a_0$</span> moves to the right, <span class="arithmatex">$a_1$</span> moves to the left, <span class="arithmatex">$a_2$</span> moves to the right and so on up to <span class="arithmatex">$a_k$</span>.</p>
<p>The parent of <span class="arithmatex">$[a_0; a_1, \dots, a_k,1]$</span> then is the fraction obtained by taking one step back in the last used direction.</p>
<p>In other words, it is <span class="arithmatex">$[a_0; a_1, \dots, a_k-1,1]$</span> when <span class="arithmatex">$a_k &gt; 1$</span> and <span class="arithmatex">$[a_0; a_1, \dots, a_{k-1}, 1]$</span> when <span class="arithmatex">$a_k = 1$</span>.</p>
<p>Thus the children of <span class="arithmatex">$[a_0; a_1, \dots, a_k, 1]$</span> are <span class="arithmatex">$[a_0; a_1, \dots, a_k+1, 1]$</span> and <span class="arithmatex">$[a_0; a_1, \dots, a_k, 1, 1]$</span>.</p>
<p>Let's index the Stern-Brocot tree. The root vertex is assigned an index <span class="arithmatex">$1$</span>. Then for a vertex <span class="arithmatex">$v$</span>, the index of its left child is assigned by changing the leading bit of <span class="arithmatex">$v$</span> from <span class="arithmatex">$1$</span> to <span class="arithmatex">$10$</span> and for the right child, it's assigned by changing the leading bit from <span class="arithmatex">$1$</span> to <span class="arithmatex">$11$</span>:</p>
<figure><img src="https://upload.wikimedia.org/wikipedia/commons/1/18/Stern-brocot-index.svg" width="500px"/></figure>

<p>In this indexing, the continued fraction representation of a rational number specifies the <a href="https://en.wikipedia.org/wiki/Run-length_encoding">run-length encoding</a> of its binary index.</p>
<p>For <span class="arithmatex">$\frac{5}{2} = [2;2] = [2;1,1]$</span>, its index is <span class="arithmatex">$1011_2$</span> and its run-length encoding, considering bits in the ascending order, is <span class="arithmatex">$[2;1,1]$</span>.</p>
<p>Another example is <span class="arithmatex">$\frac{2}{5} = [0;2,2]=[0;2,1,1]$</span>, which has index <span class="arithmatex">$1100_2$</span> and its run-length encoding is, indeed, <span class="arithmatex">$[0;2,2]$</span>.</p>
<p>It is worth noting that the Stern-Brocot tree is, in fact, a <a href="../data_structures/treap.html">treap</a>. That is, it is a binary search tree by <span class="arithmatex">$\frac{p}{q}$</span>, but it is a heap by both <span class="arithmatex">$p$</span> and <span class="arithmatex">$q$</span>.</p>
<div class="admonition example">
<p class="admonition-title">Comparing continued fractions</p>
<p>You're given <span class="arithmatex">$A=[a_0; a_1, \dots, a_n]$</span> and <span class="arithmatex">$B=[b_0; b_1, \dots, b_m]$</span>. Which fraction is smaller?</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>Assume for now that <span class="arithmatex">$A$</span> and <span class="arithmatex">$B$</span> are irrational and their continued fraction representations denote an infinite descent in the Stern-Brocot tree.</p>
<p>As we already mentioned, in this representation <span class="arithmatex">$a_0$</span> denotes the number of right turns in the descent, <span class="arithmatex">$a_1$</span> denotes the number of consequent left turns and so on. Therefore, when we compare <span class="arithmatex">$a_k$</span> and <span class="arithmatex">$b_k$</span>, if <span class="arithmatex">$a_k = b_k$</span> we should just move on to comparing <span class="arithmatex">$a_{k+1}$</span> and <span class="arithmatex">$b_{k+1}$</span>. Otherwise, if we're at right descents, we should check if <span class="arithmatex">$a_k &lt; b_k$</span> and if we're at left descents, we should check if <span class="arithmatex">$a_k &gt; b_k$</span> to tell whether <span class="arithmatex">$A &lt; B$</span>.</p>
<p>In other words, for irrational <span class="arithmatex">$A$</span> and <span class="arithmatex">$B$</span> it would be <span class="arithmatex">$A &lt; B$</span> if and only if <span class="arithmatex">$(a_0, -a_1, a_2, -a_3, \dots) &lt; (b_0, -b_1, b_2, -b_3, \dots)$</span> with lexicographical comparison.</p>
<p>Now, formally using <span class="arithmatex">$\infty$</span> as an element of continued fraction representation it is possible to emulate irrational numbers <span class="arithmatex">$A-\varepsilon$</span> and <span class="arithmatex">$A+\varepsilon$</span>, that is, elements that are smaller (greater) than <span class="arithmatex">$A$</span>, but greater (smaller) than any other real number. Specifically, for <span class="arithmatex">$A=[a_0; a_1, \dots, a_n]$</span>, one of these two elements can be emulated as <span class="arithmatex">$[a_0; a_1, \dots, a_n, \infty]$</span> and the other can be emulated as <span class="arithmatex">$[a_0; a_1, \dots, a_n - 1, 1, \infty]$</span>.</p>
<p>Which one corresponds to <span class="arithmatex">$A-\varepsilon$</span> and which one to <span class="arithmatex">$A+\varepsilon$</span> can be determined by the parity of <span class="arithmatex">$n$</span> or by comparing them as irrational numbers.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># check if a &lt; b assuming that a[-1] = b[-1] = infty and a != b</span>
<span class="k">def</span><span class="w"> </span><span class="nf">less</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">i</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">i</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span>

<span class="c1"># [a0; a1, ..., ak] -&gt; [a0, a1, ..., ak-1, 1]</span>
<span class="k">def</span><span class="w"> </span><span class="nf">expand</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span><span class="p">:</span> <span class="c1"># empty a = inf</span>
        <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="c1"># return a-eps, a+eps</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pm_eps</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
    <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">if</span> <span class="n">less</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title">Best inner point</p>
<p>You're given <span class="arithmatex">$\frac{0}{1} \leq \frac{p_0}{q_0} &lt; \frac{p_1}{q_1} \leq \frac{1}{0}$</span>. Find the rational number <span class="arithmatex">$\frac{p}{q}$</span> such that <span class="arithmatex">$(q; p)$</span> is lexicographically smallest and <span class="arithmatex">$\frac{p_0}{q_0} &lt; \frac{p}{q} &lt; \frac{p_1}{q_1}$</span>.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>In terms of the Stern-Brocot tree it means that we need to find the LCA of <span class="arithmatex">$\frac{p_0}{q_0}$</span> and <span class="arithmatex">$\frac{p_1}{q_1}$</span>. Due to the connection between Stern-Brocot tree and continued fraction, this LCA would roughly correspond to the largest common prefix of continued fraction representations for <span class="arithmatex">$\frac{p_0}{q_0}$</span> and <span class="arithmatex">$\frac{p_1}{q_1}$</span>.</p>
<p>So, if <span class="arithmatex">$\frac{p_0}{q_0} = [a_0; a_1, \dots, a_{k-1}, a_k, \dots]$</span> and <span class="arithmatex">$\frac{p_1}{q_1} = [a_0; a_1, \dots, a_{k-1}, b_k, \dots]$</span> are irrational numbers, the LCA is <span class="arithmatex">$[a_0; a_1, \dots, \min(a_k, b_k)+1]$</span>.</p>
<p>For rational <span class="arithmatex">$r_0$</span> and <span class="arithmatex">$r_1$</span>, one of them could be the LCA itself which would require us to casework it. To simplify the solution for rational <span class="arithmatex">$r_0$</span> and <span class="arithmatex">$r_1$</span>, it is possible to use continued fraction representation of <span class="arithmatex">$r_0 + \varepsilon$</span> and <span class="arithmatex">$r_1 - \varepsilon$</span> which was derived in the previous problem.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># finds lexicographically smallest (q, p)</span>
<span class="c1"># such that p0/q0 &lt; p/q &lt; p1/q1</span>
<span class="k">def</span><span class="w"> </span><span class="nf">middle</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
    <span class="n">a0</span> <span class="o">=</span> <span class="n">pm_eps</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">q0</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">pm_eps</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a0</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="p">))):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">a0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">a0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="k">break</span>
    <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://codingcompetitions.withgoogle.com/codejam/round/0000000000051679/0000000000146184">GCJ 2019, Round 2 - New Elements: Part 2</a></p>
<p>You're given <span class="arithmatex">$N$</span> positive integer pairs <span class="arithmatex">$(C_i, J_i)$</span>. You need to find a positive integer pair <span class="arithmatex">$(x, y)$</span> such that <span class="arithmatex">$C_i x + J_i y$</span> is a strictly increasing sequence.</p>
<p>Among such pairs, find the lexicographically minimum one.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>Rephrasing the statement, <span class="arithmatex">$A_i x + B_i y$</span> must be positive for all <span class="arithmatex">$i$</span>, where <span class="arithmatex">$A_i = C_i - C_{i-1}$</span> and <span class="arithmatex">$B_i = J_i - J_{i-1}$</span>.</p>
<p>Among such equations we have four significant groups for <span class="arithmatex">$A_i x + B_i y &gt; 0$</span>:</p>
<ol>
<li><span class="arithmatex">$A_i, B_i &gt; 0$</span> can be ignored since we're looking for <span class="arithmatex">$x, y &gt; 0$</span>.</li>
<li><span class="arithmatex">$A_i, B_i \leq 0$</span> would provide "IMPOSSIBLE" as an answer.</li>
<li><span class="arithmatex">$A_i &gt; 0$</span>, <span class="arithmatex">$B_i \leq 0$</span>. Such constraints are equivalent to <span class="arithmatex">$\frac{y}{x} &lt; \frac{A_i}{-B_i}$</span>.</li>
<li><span class="arithmatex">$A_i \leq 0$</span>, <span class="arithmatex">$B_i &gt; 0$</span>. Such constraints are equivalent to <span class="arithmatex">$\frac{y}{x} &gt; \frac{-A_i}{B_i}$</span>.</li>
</ol>
<p>Let <span class="arithmatex">$\frac{p_0}{q_0}$</span> be the largest <span class="arithmatex">$\frac{-A_i}{B_i}$</span> from the fourth group and <span class="arithmatex">$\frac{p_1}{q_1}$</span> be the smallest <span class="arithmatex">$\frac{A_i}{-B_i}$</span> from the third group.</p>
<p>The problem is now, given <span class="arithmatex">$\frac{p_0}{q_0} &lt; \frac{p_1}{q_1}$</span>, find a fraction <span class="arithmatex">$\frac{p}{q}$</span> such that <span class="arithmatex">$(q;p)$</span> is lexicographically smallest and <span class="arithmatex">$\frac{p_0}{q_0} &lt; \frac{p}{q} &lt; \frac{p_1}{q_1}$</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">():</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="n">C</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="c1"># p0/q0 &lt; y/x &lt; p1/q1</span>
    <span class="n">p0</span><span class="p">,</span> <span class="n">q0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">fail</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">A</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">B</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">fail</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">A</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># y/x &gt; (-A)/B if B &gt; 0</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">-</span><span class="n">A</span><span class="p">)</span><span class="o">*</span><span class="n">q0</span> <span class="o">&gt;</span> <span class="n">p0</span><span class="o">*</span><span class="n">B</span><span class="p">:</span>
                    <span class="n">p0</span><span class="p">,</span> <span class="n">q0</span> <span class="o">=</span> <span class="o">-</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span>
            <span class="k">elif</span> <span class="n">B</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># y/x &lt; A/(-B) if B &lt; 0</span>
                <span class="k">if</span> <span class="n">A</span><span class="o">*</span><span class="n">q1</span> <span class="o">&lt;</span> <span class="n">p1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">B</span><span class="p">):</span>
                    <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">A</span><span class="p">,</span> <span class="o">-</span><span class="n">B</span>
    <span class="k">if</span> <span class="n">p0</span><span class="o">*</span><span class="n">q1</span> <span class="o">&gt;=</span> <span class="n">p1</span><span class="o">*</span><span class="n">q0</span> <span class="ow">or</span> <span class="n">fail</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;IMPOSSIBLE&#39;</span>

    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">middle</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<h3 id="calkin-wilf-tree">Calkin-Wilf tree<a class="headerlink" href="#calkin-wilf-tree" title="Permanent link">&para;</a></h3>
<p>A somewhat simpler way to organize continued fractions in a binary tree is the <a href="https://en.wikipedia.org/wiki/CalkinWilf_tree">Calkin-Wilf tree</a>.</p>
<p>The tree generally looks like this:</p>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/8/82/CalkinWilf_tree.svg" width="500px"/>
<figcaption><a href="https://commons.wikimedia.org/wiki/File:CalkinWilf_tree.svg">The image</a> by <a href="https://commons.wikimedia.org/wiki/User:Olli_Niemitalo">Olli Niemitalo</a>, <a href="https://commons.wikimedia.org/wiki/User:Proz">Proz</a> is licensed under <a href="https://creativecommons.org/publicdomain/zero/1.0/deed.en">CC0 1.0</a></figcaption>
</figure>

<p>In the root of the tree, the number <span class="arithmatex">$\frac{1}{1}$</span> is located. Then, for the vertex with a number <span class="arithmatex">$\frac{p}{q}$</span>, its children are <span class="arithmatex">$\frac{p}{p+q}$</span> and <span class="arithmatex">$\frac{p+q}{q}$</span>.</p>
<p>Unlike the Stern-Brocot tree, the Calkin-Wilf tree is not a binary <em>search</em> tree, so it can't be used to perform rational binary search.</p>
<p>In the Calkin-Wilf tree, the direct parent of a fraction <span class="arithmatex">$\frac{p}{q}$</span> is <span class="arithmatex">$\frac{p-q}{q}$</span> when <span class="arithmatex">$p&gt;q$</span> and <span class="arithmatex">$\frac{p}{q-p}$</span> otherwise.</p>
<p>For the Stern-Brocot tree, we used the recurrence for convergents. To draw the connection between the continued fraction and the Calkin-Wilf tree, we should recall the recurrence for complete quotients. If <span class="arithmatex">$s_k = \frac{p}{q}$</span>, then <span class="arithmatex">$s_{k+1} = \frac{q}{p \mod q} = \frac{q}{p-\lfloor p/q \rfloor \cdot q}$</span>.</p>
<p>On the other hand, if we repeatedly go from <span class="arithmatex">$s_k = \frac{p}{q}$</span> to its parent in the Calkin-Wilf tree when <span class="arithmatex">$p &gt; q$</span>, we will end up in <span class="arithmatex">$\frac{p \mod q}{q} = \frac{1}{s_{k+1}}$</span>. If we continue doing so, we will end up in <span class="arithmatex">$s_{k+2}$</span>, then <span class="arithmatex">$\frac{1}{s_{k+3}}$</span> and so on. From this we can deduce that:</p>
<ol>
<li>When <span class="arithmatex">$a_0&gt; 0$</span>, the direct parent of <span class="arithmatex">$[a_0; a_1, \dots, a_k]$</span> in the Calkin-Wilf tree is <span class="arithmatex">$\frac{p-q}{q}=[a_0 - 1; a_1, \dots, a_k]$</span>.</li>
<li>When <span class="arithmatex">$a_0 = 0$</span> and <span class="arithmatex">$a_1 &gt; 1$</span>, its direct parent is <span class="arithmatex">$\frac{p}{q-p} = [0; a_1 - 1, a_2, \dots, a_k]$</span>.</li>
<li>And when <span class="arithmatex">$a_0 = 0$</span> and <span class="arithmatex">$a_1 = 1$</span>, its direct parent is <span class="arithmatex">$\frac{p}{q-p} = [a_2; a_3, \dots, a_k]$</span>.</li>
</ol>
<p>Correspondingly, children of <span class="arithmatex">$\frac{p}{q} = [a_0; a_1, \dots, a_k]$</span> are</p>
<ol>
<li><span class="arithmatex">$\frac{p+q}{q}=1+\frac{p}{q}$</span>, which is <span class="arithmatex">$[a_0+1; a_1, \dots, a_k]$</span>,</li>
<li><span class="arithmatex">$\frac{p}{p+q} = \frac{1}{1+\frac{q}{p}}$</span>, which is <span class="arithmatex">$[0, 1, a_0, a_1, \dots, a_k]$</span> for <span class="arithmatex">$a_0 &gt; 0$</span> and <span class="arithmatex">$[0, a_1+1, a_2, \dots, a_k]$</span> for <span class="arithmatex">$a_0=0$</span>.</li>
</ol>
<p>Noteworthy, if we enumerate vertices of the Calkin-Wilf tree in the breadth-first search order (that is, the root has a number <span class="arithmatex">$1$</span>, and the children of the vertex <span class="arithmatex">$v$</span> have indices <span class="arithmatex">$2v$</span> and <span class="arithmatex">$2v+1$</span> correspondingly), the index of the rational number in the Calkin-Wilf tree would be the same as in the Stern-Brocot tree.</p>
<p>Thus, numbers on the same levels of the Stern-Brocot tree and the Calkin-Wilf tree are the same, but their ordering differs through the <a href="https://en.wikipedia.org/wiki/Bit-reversal_permutation">bit-reversal permutation</a>.</p>
<h2 id="convergence">Convergence<a class="headerlink" href="#convergence" title="Permanent link">&para;</a></h2>
<p>For the number <span class="arithmatex">$r$</span> and its <span class="arithmatex">$k$</span>-th convergent <span class="arithmatex">$r_k=\frac{p_k}{q_k}$</span> the following formula stands:</p>
<div class="arithmatex">$$r_k = a_0 + \sum\limits_{i=1}^k \frac{(-1)^{i-1}}{q_i q_{i-1}}.$$</div>
<p>In particular, it means that </p>
<div class="arithmatex">$$r_k - r_{k-1} = \frac{(-1)^{k-1}}{q_k q_{k-1}}$$</div>
<p>and </p>
<div class="arithmatex">$$p_k q_{k-1} - p_{k-1} q_k = (-1)^{k-1}.$$</div>
<p>From this we can conclude that</p>
<div class="arithmatex">$$\left| r-\frac{p_k}{q_k} \right| \leq \frac{1}{q_{k+1}q_k} \leq \frac{1}{q_k^2}.$$</div>
<p>The latter inequality is due to the fact that <span class="arithmatex">$r_k$</span> and <span class="arithmatex">$r_{k+1}$</span> are generally located on different sides of <span class="arithmatex">$r$</span>, thus</p>
<div class="arithmatex">$$|r-r_k| = |r_k-r_{k+1}|-|r-r_{k+1}| \leq |r_k - r_{k+1}|.$$</div>
<details class="tip">
<summary>Detailed explanation</summary>
<p>To estimate <span class="arithmatex">$|r-r_k|$</span>, we start by estimating the difference between adjacent convergents. By definition,</p>
<div class="arithmatex">$$\frac{p_k}{q_k} - \frac{p_{k-1}}{q_{k-1}} = \frac{p_k q_{k-1} - p_{k-1} q_k}{q_k q_{k-1}}.$$</div>
<p>Replacing <span class="arithmatex">$p_k$</span> and <span class="arithmatex">$q_k$</span> in the numerator with their recurrences, we get</p>
<div class="arithmatex">$$\begin{align} p_k q_{k-1} - p_{k-1} q_k &amp;= (a_k p_{k-1} + p_{k-2}) q_{k-1} - p_{k-1} (a_k q_{k-1} + q_{k-2})
\\&amp;= p_{k-2} q_{k-1} - p_{k-1} q_{k-2},\end{align}$$</div>
<p>thus the numerator of <span class="arithmatex">$r_k - r_{k-1}$</span> is always the negated numerator of <span class="arithmatex">$r_{k-1} - r_{k-2}$</span>. It, in turn, equals to <span class="arithmatex">$1$</span> for</p>
<div class="arithmatex">$$r_1 - r_0=\left(a_0+\frac{1}{a_1}\right)-a_0=\frac{1}{a_1},$$</div>
<p>thus</p>
<div class="arithmatex">$$r_k - r_{k-1} = \frac{(-1)^{k-1}}{q_k q_{k-1}}.$$</div>
<p>This yields an alternative representation of <span class="arithmatex">$r_k$</span> as a partial sum of infinite series:</p>
<div class="arithmatex">$$r_k = (r_k - r_{k-1}) + \dots + (r_1 - r_0) + r_0
= a_0 + \sum\limits_{i=1}^k \frac{(-1)^{i-1}}{q_i q_{i-1}}.$$</div>
<p>From the recurrent relation it follows that <span class="arithmatex">$q_k$</span> monotonously increases at least as fast as Fibonacci numbers, thus</p>
<div class="arithmatex">$$r = \lim\limits_{k \to \infty} r_k = a_0 + \sum\limits_{i=1}^\infty \frac{(-1)^{i-1}}{q_i q_{i-1}}$$</div>
<p>is always well-defined, as the underlying series always converge. Noteworthy, the residual series</p>
<div class="arithmatex">$$r-r_k = \sum\limits_{i=k+1}^\infty \frac{(-1)^{i-1}}{q_i q_{i-1}}$$</div>
<p>has the same sign as <span class="arithmatex">$(-1)^k$</span> due to how fast <span class="arithmatex">$q_i q_{i-1}$</span> decreases. Hence even-indexed <span class="arithmatex">$r_k$</span> approach <span class="arithmatex">$r$</span> from below while odd-indexed <span class="arithmatex">$r_k$</span> approach it from above:</p>
<p><figure><img src="https://upload.wikimedia.org/wikipedia/commons/b/b4/Golden_ration_convergents.svg" width="600px"/>
<figcaption><em>Convergents of <span class="arithmatex">$r=\phi = \frac{1+\sqrt{5}}{2}=[1;1,1,\dots]$</span> and their distance from <span class="arithmatex">$r$</span>.</em></figcaption></figure></p>
<p>From this picture we can see that</p>
<div class="arithmatex">$$|r-r_k| = |r_k - r_{k+1}| - |r-r_{k+1}| \leq |r_k - r_{k+1}|,$$</div>
<p>thus the distance between <span class="arithmatex">$r$</span> and <span class="arithmatex">$r_k$</span> is never larger than the distance between <span class="arithmatex">$r_k$</span> and <span class="arithmatex">$r_{k+1}$</span>:</p>
<div class="arithmatex">$$\left|r-\frac{p_k}{q_k}\right| \leq \frac{1}{q_k q_{k+1}} \leq \frac{1}{q_k^2}.$$</div>
</details>
<div class="admonition example">
<p class="admonition-title">Extended Euclidean?</p>
<p>You're given <span class="arithmatex">$A, B, C \in \mathbb Z$</span>. Find <span class="arithmatex">$x, y \in \mathbb Z$</span> such that <span class="arithmatex">$Ax + By = C$</span>.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>Although this problem is typically solved with the <a href="extended-euclid-algorithm.html">extended Euclidean algorithm</a>, there is a simple and straightforward solution with continued fractions.</p>
<p>Let <span class="arithmatex">$\frac{A}{B}=[a_0; a_1, \dots, a_k]$</span>. It was proved above that <span class="arithmatex">$p_k q_{k-1} - p_{k-1} q_k = (-1)^{k-1}$</span>. Substituting <span class="arithmatex">$p_k$</span> and <span class="arithmatex">$q_k$</span> with <span class="arithmatex">$A$</span> and <span class="arithmatex">$B$</span>, we get</p>
<div class="arithmatex">$$Aq_{k-1} - Bp_{k-1} = (-1)^{k-1} g,$$</div>
<p>where <span class="arithmatex">$g = \gcd(A, B)$</span>. If <span class="arithmatex">$C$</span> is divisible by <span class="arithmatex">$g$</span>, then the solution is <span class="arithmatex">$x = (-1)^{k-1}\frac{C}{g} q_{k-1}$</span> and <span class="arithmatex">$y = (-1)^{k}\frac{C}{g} p_{k-1}$</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># return (x, y) such that Ax+By=C</span>
<span class="c1"># assumes that such (x, y) exists</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dio</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>
    <span class="n">C</span> <span class="o">//=</span> <span class="n">A</span> <span class="o">//</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># divide by gcd(A, B)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">t</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="n">t</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="linear-fractional-transformations">Linear fractional transformations<a class="headerlink" href="#linear-fractional-transformations" title="Permanent link">&para;</a></h2>
<p>Another important concept for continued fractions are the so-called <a href="https://en.wikipedia.org/wiki/Linear_fractional_transformation">linear fractional transformations</a>.</p>
<div class="admonition info">
<p class="admonition-title">Definition</p>
<p>A <strong>linear fractional transformation</strong> is a function <span class="arithmatex">$f : \mathbb R \to \mathbb R$</span> such that <span class="arithmatex">$f(x) = \frac{ax+b}{cx+d}$</span> for some <span class="arithmatex">$a,b,c,d \in \mathbb R$</span>.</p>
</div>
<p>A composition <span class="arithmatex">$(L_0 \circ L_1)(x) = L_0(L_1(x))$</span> of linear fractional transforms <span class="arithmatex">$L_0(x)=\frac{a_0 x + b_0}{c_0 x + d_0}$</span> and <span class="arithmatex">$L_1(x)=\frac{a_1 x + b_1}{c_1 x + d_1}$</span> is itself a linear fractional transform:</p>
<div class="arithmatex">$$\frac{a_0\frac{a_1 x + b_1}{c_1 x + d_1} + b_0}{c_0 \frac{a_1 x + b_1}{c_1 x + d_1} + d_0} = \frac{a_0(a_1 x + b_1) + b_0 (c_1 x + d_1)}{c_0 (a_1 x + b_1) + d_0 (c_1 x + d_1)} = \frac{(a_0 a_1 + b_0 c_1) x + (a_0 b_1 + b_0 d_1)}{(c_0 a_1 + d_0 c_1) x + (c_0 b_1 + d_0 d_1)}.$$</div>
<p>Inverse of a linear fractional transform, is also a linear fractional transform:</p>
<div class="arithmatex">$$y = \frac{ax+b}{cx+d} \iff y(cx+d) = ax + b \iff x = -\frac{dy-b}{cy-a}.$$</div>
<div class="admonition example">
<p class="admonition-title"><a href="https://dmoj.ca/problem/dmopc19c7p4">DMOPC '19 Contest 7 P4 - Bob and Continued Fractions</a></p>
<p>You're given an array of positive integers <span class="arithmatex">$a_1, \dots, a_n$</span>. You need to answer <span class="arithmatex">$m$</span> queries. Each query is to compute <span class="arithmatex">$[a_l; a_{l+1}, \dots, a_r]$</span>.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>We can solve this problem with the segment tree if we're able to concatenate continued fractions.</p>
<p>It's generally true that <span class="arithmatex">$[a_0; a_1, \dots, a_k, b_0, b_1, \dots, b_k] = [a_0; a_1, \dots, a_k, [b_1; b_2, \dots, b_k]]$</span>.</p>
<p>Let's denote <span class="arithmatex">$L_{k}(x) = [a_k; x] = a_k + \frac{1}{x} = \frac{a_k\cdot x+1}{1\cdot x + 0}$</span>. Note that <span class="arithmatex">$L_k(\infty) = a_k$</span>. In this notion, it holds that</p>
<div class="arithmatex">$$[a_0; a_1, \dots, a_k, x] = [a_0; [a_1; [\dots; [a_k; x]]]] = (L_0 \circ L_1 \circ \dots \circ L_k)(x) = \frac{p_k x + p_{k-1}}{q_k x + q_{k-1}}.$$</div>
<p>Thus, the problem boils down to the computation of</p>
<div class="arithmatex">$$(L_l \circ L_{l+1} \circ \dots \circ L_r)(\infty).$$</div>
<p>Composition of transforms is associative, so it's possible to compute in each node of a segment tree the composition of transforms in its subtree.</p>
</details>
<div class="admonition example">
<p class="admonition-title">Linear fractional transformation of a continued fraction</p>
<p>Let <span class="arithmatex">$L(x) = \frac{ax+b}{cx+d}$</span>. Compute the continued fraction representation <span class="arithmatex">$[b_0; b_1, \dots, b_m]$</span> of <span class="arithmatex">$L(A)$</span> for <span class="arithmatex">$A=[a_0; a_1, \dots, a_n]$</span>.</p>
<p><em>This allows to compute <span class="arithmatex">$A + \frac{p}{q} = \frac{qA + p}{q}$</span> and <span class="arithmatex">$A \cdot \frac{p}{q} = \frac{p A}{q}$</span> for any <span class="arithmatex">$\frac{p}{q}$</span>.</em></p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>As we noted above, <span class="arithmatex">$[a_0; a_1, \dots, a_k] = (L_{a_0} \circ L_{a_1} \circ \dots \circ L_{a_k})(\infty)$</span>, hence <span class="arithmatex">$L([a_0; a_1, \dots, a_k]) = (L \circ L_{a_0} \circ L_{a_1} \circ \dots L_{a_k})(\infty)$</span>.</p>
<p>Hence, by consequentially adding <span class="arithmatex">$L_{a_0}$</span>, <span class="arithmatex">$L_{a_1}$</span> and so on we would be able to compute</p>
<div class="arithmatex">$$(L \circ L_{a_0} \circ \dots \circ L_{a_k})(x) = L\left(\frac{p_k x + p_{k-1}}{q_k x + q_{k-1}}\right)=\frac{a_k x + b_k}{c_k x + d_k}.$$</div>
<p>Since <span class="arithmatex">$L(x)$</span> is invertible, it is also monotonous in <span class="arithmatex">$x$</span>. Therefore, for any <span class="arithmatex">$x \geq 0$</span> it holds that <span class="arithmatex">$L(\frac{p_k x + p_{k-1}}{q_k x + q_{k-1}})$</span> is between <span class="arithmatex">$L(\frac{p_k}{q_k}) = \frac{a_k}{c_k}$</span> and <span class="arithmatex">$L(\frac{p_{k-1}}{q_{k-1}}) = \frac{b_k}{d_k}$</span>.</p>
<p>Moreover, for <span class="arithmatex">$x=[a_{k+1}; \dots, a_n]$</span> it is equal to <span class="arithmatex">$L(A)$</span>. Hence, <span class="arithmatex">$b_0 = \lfloor L(A) \rfloor$</span> is between <span class="arithmatex">$\lfloor L(\frac{p_k}{q_k}) \rfloor$</span> and <span class="arithmatex">$\lfloor L(\frac{p_{k-1}}{q_{k-1}}) \rfloor$</span>. When they're equal, they're also equal to <span class="arithmatex">$b_0$</span>.</p>
<p>Note that <span class="arithmatex">$L(A) = (L_{b_0} \circ L_{b_1} \circ \dots \circ L_{b_m})(\infty)$</span>. Knowing <span class="arithmatex">$b_0$</span>, we can compose <span class="arithmatex">$L_{b_0}^{-1}$</span> with the current transform and continue adding <span class="arithmatex">$L_{a_{k+1}}$</span>, <span class="arithmatex">$L_{a_{k+2}}$</span> and so on, looking for new floors to agree, from which we would be able to deduce <span class="arithmatex">$b_1$</span> and so on until we recover all values of <span class="arithmatex">$[b_0; b_1, \dots, b_m]$</span>.</p>
</details>
<div class="admonition example">
<p class="admonition-title">Continued fraction arithmetics</p>
<p>Let <span class="arithmatex">$A=[a_0; a_1, \dots, a_n]$</span> and <span class="arithmatex">$B=[b_0; b_1, \dots, b_m]$</span>. Compute the continued fraction representations of <span class="arithmatex">$A+B$</span> and <span class="arithmatex">$A \cdot B$</span>.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>Idea here is similar to the previous problem, but instead of <span class="arithmatex">$L(x) = \frac{ax+b}{cx+d}$</span> you should consider bilinear fractional transform <span class="arithmatex">$L(x, y) = \frac{axy+bx+cy+d}{exy+fx+gy+h}$</span>.</p>
<p>Rather than <span class="arithmatex">$L(x) \mapsto L(L_{a_k}(x))$</span> you would change your current transform as <span class="arithmatex">$L(x, y) \mapsto L(L_{a_k}(x), y)$</span> or <span class="arithmatex">$L(x, y) \mapsto L(x, L_{b_k}(y))$</span>.</p>
<p>Then, you check if <span class="arithmatex">$\lfloor \frac{a}{e} \rfloor = \lfloor \frac{b}{f} \rfloor = \lfloor \frac{c}{g} \rfloor = \lfloor \frac{d}{h} \rfloor$</span> and if they all agree, you use this value as <span class="arithmatex">$c_k$</span> in the resulting fraction and change the transform as</p>
<div class="arithmatex">$$L(x, y) \mapsto \frac{1}{L(x, y) - c_k}.$$</div>
</details>
<div class="admonition info">
<p class="admonition-title">Definition</p>
<p>A continued fraction <span class="arithmatex">$x = [a_0; a_1, \dots]$</span> is said to be <strong>periodic</strong> if <span class="arithmatex">$x = [a_0; a_1, \dots, a_k, x]$</span> for some <span class="arithmatex">$k$</span>.</p>
<p>A continued fraction <span class="arithmatex">$x = [a_0; a_1, \dots]$</span> is said to be <strong>eventually periodic</strong> if <span class="arithmatex">$x = [a_0; a_1, \dots, a_k, y]$</span>, where <span class="arithmatex">$y$</span> is periodic.</p>
</div>
<p>For <span class="arithmatex">$x = [1; 1, 1, \dots]$</span> it holds that <span class="arithmatex">$x = 1 + \frac{1}{x}$</span>, thus <span class="arithmatex">$x^2 = x + 1$</span>. There is a generic connection between periodic continued fractions and quadratic equations. Consider the following equation:</p>
<div class="arithmatex">$$ x = [a_0; a_1, \dots, a_k, x].$$</div>
<p>On one hand, this equation means that the continued fraction representation of <span class="arithmatex">$x$</span> is periodic with the period <span class="arithmatex">$k+1$</span>.</p>
<p>On the other hand, using the formula for convergents, this equation means that</p>
<div class="arithmatex">$$x = \frac{p_k x + p_{k-1}}{q_k x + q_{k-1}}.$$</div>
<p>That is, <span class="arithmatex">$x$</span> is a linear fractional transformation of itself. It follows from the equation that <span class="arithmatex">$x$</span> is a root of the second degree equation:</p>
<div class="arithmatex">$$q_k x^2 + (q_{k-1}-p_k)x - p_{k-1} = 0.$$</div>
<p>Similar reasoning stands for continued fractions that are eventually periodic, that is <span class="arithmatex">$x = [a_0; a_1, \dots, a_k, y]$</span> for <span class="arithmatex">$y=[b_0; b_1, \dots, b_k, y]$</span>. Indeed, from first equation we derive that <span class="arithmatex">$x = L_0(y)$</span> and from second equation that <span class="arithmatex">$y = L_1(y)$</span>, where <span class="arithmatex">$L_0$</span> and <span class="arithmatex">$L_1$</span> are linear fractional transformations. Therefore,</p>
<div class="arithmatex">$$x = (L_0 \circ L_1)(y) = (L_0 \circ L_1 \circ L_0^{-1})(x).$$</div>
<p>One can further prove (and it was first done by Lagrange) that for arbitrary quadratic equation <span class="arithmatex">$ax^2+bx+c=0$</span> with integer coefficients, its solution <span class="arithmatex">$x$</span> is an eventually periodic continued fraction.</p>
<div class="admonition example">
<p class="admonition-title">Quadratic irrationality</p>
<p>Find the continued fraction of <span class="arithmatex">$\alpha = \frac{x+y\sqrt{n}}{z}$</span> where <span class="arithmatex">$x, y, z, n \in \mathbb Z$</span> and <span class="arithmatex">$n &gt; 0$</span> is not a perfect square.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>For the <span class="arithmatex">$k$</span>-th complete quotient <span class="arithmatex">$s_k$</span> of the number it generally holds that</p>
<div class="arithmatex">$$\alpha = [a_0; a_1, \dots, a_{k-1}, s_k] = \frac{s_k p_{k-1} + p_{k-2}}{s_k q_{k-1} + q_{k-2}}.$$</div>
<p>Therefore, </p>
<div class="arithmatex">$$s_k = -\frac{\alpha q_{k-1} - p_{k-1}}{\alpha q_k - p_k} = -\frac{q_{k-1} y \sqrt n + (x q_{k-1} - z p_{k-1})}{q_k y \sqrt n + (xq_k-zp_k)}.$$</div>
<p>Multiplying the numerator and denominator by <span class="arithmatex">$(xq_k - zp_k) - q_k y \sqrt n$</span>, we'll get rid of <span class="arithmatex">$\sqrt n$</span> in the denominator, thus the complete quotients are of form</p>
<div class="arithmatex">$$s_k = \frac{x_k + y_k \sqrt n}{z_k}.$$</div>
<p>Let's find <span class="arithmatex">$s_{k+1}$</span>, assuming that <span class="arithmatex">$s_k$</span> is known.</p>
<p>First of all, <span class="arithmatex">$a_k = \lfloor s_k \rfloor = \left\lfloor \frac{x_k + y_k \lfloor \sqrt n \rfloor}{z_k} \right\rfloor$</span>. Then,</p>
<div class="arithmatex">$$s_{k+1} = \frac{1}{s_k-a_k} = \frac{z_k}{(x_k - z_k a_k) + y_k \sqrt n} = \frac{z_k (x_k - y_k a_k) - y_k z_k \sqrt n}{(x_k - y_k a_k)^2 - y_k^2 n}.$$</div>
<p>Thus, if we denote <span class="arithmatex">$t_k = x_k - y_k a_k$</span>, it will hold that</p>
<div class="arithmatex">$$\begin{align}x_{k+1} &amp;=&amp; z_k t_k, \\ y_{k+1} &amp;=&amp; -y_k z_k, \\ z_{k+1} &amp;=&amp; t_k^2 - y_k^2 n.\end{align}$$</div>
<p>Nice thing about such representation is that if we reduce <span class="arithmatex">$x_{k+1}, y_{k+1}, z_{k+1}$</span> by their greatest common divisor, the result would be unique. Therefore, we may use it to check whether the current state has already been repeated and also to check where was the previous index that had this state.</p>
<p>Below is the code to compute the continued fraction representation for <span class="arithmatex">$\alpha = \sqrt n$</span>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># compute the continued fraction of sqrt(n)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">n0</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span> <span class="o">*</span> <span class="n">n0</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="o">//</span> <span class="n">z</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">z</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">n</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">//</span> <span class="n">g</span><span class="p">,</span> <span class="n">y</span> <span class="o">//</span> <span class="n">g</span><span class="p">,</span> <span class="n">z</span> <span class="o">//</span> <span class="n">g</span>

    <span class="n">used</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">used</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">step</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="n">used</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span>
</code></pre></div>
</div>
</div>
</div>
<p>Using the same <code>step</code> function but different initial <span class="arithmatex">$x$</span>, <span class="arithmatex">$y$</span> and <span class="arithmatex">$z$</span> it is possible to compute it for arbitrary <span class="arithmatex">$\frac{x+y \sqrt{n}}{z}$</span>.</p>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://timus.online/problem.aspx?space=1&amp;num=1814">Tavrida NU Akai Contest - Continued Fraction</a></p>
<p>You're given <span class="arithmatex">$x$</span> and <span class="arithmatex">$k$</span>, <span class="arithmatex">$x$</span> is not a perfect square. Let <span class="arithmatex">$\sqrt x = [a_0; a_1, \dots]$</span>, find <span class="arithmatex">$\frac{p_k}{q_k}=[a_0; a_1, \dots, a_k]$</span> for <span class="arithmatex">$0 \leq k \leq 10^9$</span>.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>After computing the period of <span class="arithmatex">$\sqrt x$</span>, it is possible to compute <span class="arithmatex">$a_k$</span> using binary exponentiation on the linear fractional transformation induced by the continued fraction representation. To find the resulting transformation, you compress the period of size <span class="arithmatex">$T$</span> into a single transformation and repeat it <span class="arithmatex">$\lfloor \frac{k-1}{T}\rfloor$</span> times, after which you manually combine it with the remaining transformations.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

<span class="n">mod</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="o">+</span><span class="mi">7</span>

<span class="c1"># compose (A[0]*x + A[1]) / (A[2]*x + A[3]) and (B[0]*x + B[1]) / (B[2]*x + B[3])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">combine</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">t</span> <span class="o">%</span> <span class="n">mod</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="mi">3</span><span class="p">]]]</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># (x + 0) / (0*x + 1) = x</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1"># period of a</span>

<span class="c1"># apply ak + 1/x = (ak*x+1)/(1x+0) to (Ax + B) / (Cx + D)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">combine</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">A</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">bpow</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span> <span class="k">else</span> <span class="n">combine</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">bpow</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">bpow</span><span class="p">(</span><span class="n">combine</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="p">),</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># = 1 / 0</span>
<span class="k">while</span> <span class="n">k</span> <span class="o">%</span> <span class="n">T</span><span class="p">:</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">k</span> <span class="o">%</span> <span class="n">T</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">combine</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">C</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">bpow</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">k</span> <span class="o">//</span> <span class="n">T</span><span class="p">),</span> <span class="n">C</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">combine</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">C</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="geometric-interpretation">Geometric interpretation<a class="headerlink" href="#geometric-interpretation" title="Permanent link">&para;</a></h2>
<p>Let <span class="arithmatex">$\vec r_k = (q_k;p_k)$</span> for the convergent <span class="arithmatex">$r_k = \frac{p_k}{q_k}$</span>. Then, the following recurrence holds:</p>
<div class="arithmatex">$$\vec r_k = a_k \vec r_{k-1} + \vec r_{k-2}.$$</div>
<p>Let <span class="arithmatex">$\vec r = (1;r)$</span>. Then, each vector <span class="arithmatex">$(x;y)$</span> corresponds to the number that is equal to its slope coefficient <span class="arithmatex">$\frac{y}{x}$</span>.</p>
<p>With the notion of <a href="../geometry/basic-geometry.html">pseudoscalar product</a> <span class="arithmatex">$(x_1;y_1) \times (x_2;y_2) = x_1 y_2 - x_2 y_1$</span>, it can be shown (see the explanation below) that</p>
<div class="arithmatex">$$s_k = -\frac{\vec r_{k-2} \times \vec r}{\vec r_{k-1} \times \vec r} = \left|\frac{\vec r_{k-2} \times \vec r}{\vec r_{k-1} \times \vec r}\right|.$$</div>
<p>The last equation is due to the fact that <span class="arithmatex">$r_{k-1}$</span> and <span class="arithmatex">$r_{k-2}$</span> lie on the different sides of <span class="arithmatex">$r$</span>, thus pseudoscalar products of <span class="arithmatex">$\vec r_{k-1}$</span> and <span class="arithmatex">$\vec r_{k-2}$</span> with <span class="arithmatex">$\vec r$</span> have distinct signs. With <span class="arithmatex">$a_k = \lfloor s_k \rfloor$</span> in mind, formula for <span class="arithmatex">$\vec r_k$</span> now looks like</p>
<div class="arithmatex">$$\vec r_k = \vec r_{k-2} + \left\lfloor \left| \frac{\vec r \times \vec r_{k-2}}{\vec r \times \vec r_{k-1}}\right|\right\rfloor \vec r_{k-1}.$$</div>
<p>Note that <span class="arithmatex">$\vec r_k \times r = (q;p) \times (1;r) = qr - p$</span>, thus</p>
<div class="arithmatex">$$a_k = \left\lfloor \left| \frac{q_{k-1}r-p_{k-1}}{q_{k-2}r-p_{k-2}} \right| \right\rfloor.$$</div>
<details class="hint">
<summary>Explanation</summary>
<p>As we have already noted, <span class="arithmatex">$a_k = \lfloor s_k \rfloor$</span>, where <span class="arithmatex">$s_k = [a_k; a_{k+1}, a_{k+2}, \dots]$</span>. On the other hand, from the convergent recurrence we derive that</p>
<div class="arithmatex">$$r = [a_0; a_1, \dots, a_{k-1}, s_k] = \frac{s_k p_{k-1} + p_{k-2}}{s_k q_{k-1} + q_{k-2}}.$$</div>
<p>In vector form, it rewrites as</p>
<div class="arithmatex">$$\vec r \parallel s_k \vec r_{k-1} + \vec r_{k-2},$$</div>
<p>meaning that <span class="arithmatex">$\vec r$</span> and <span class="arithmatex">$s_k \vec r_{k-1} + \vec r_{k-2}$</span> are collinear (that is, have the same slope coefficient). Taking the <a href="../geometry/basic-geometry.html">pseudoscalar product</a> of both parts with <span class="arithmatex">$\vec r$</span>, we get</p>
<div class="arithmatex">$$0 = s_k (\vec r_{k-1} \times \vec r) + (\vec r_{k-2} \times \vec r),$$</div>
<p>which yields the final formula</p>
<div class="arithmatex">$$s_k = -\frac{\vec r_{k-2} \times \vec r}{\vec r_{k-1} \times \vec r}.$$</div>
</details>
<div class="admonition example">
<p class="admonition-title">Nose stretching algorithm</p>
<p>Each time you add <span class="arithmatex">$\vec r_{k-1}$</span> to the vector <span class="arithmatex">$\vec p$</span>, the value of <span class="arithmatex">$\vec p \times \vec r$</span> is increased by <span class="arithmatex">$\vec r_{k-1} \times \vec r$</span>.</p>
<p>Thus, <span class="arithmatex">$a_k=\lfloor s_k \rfloor$</span> is the maximum integer number of <span class="arithmatex">$\vec r_{k-1}$</span> vectors that can be added to <span class="arithmatex">$\vec r_{k-2}$</span> without changing the sign of the cross product with <span class="arithmatex">$\vec r$</span>.</p>
<p>In other words, <span class="arithmatex">$a_k$</span> is the maximum integer number of times you can add <span class="arithmatex">$\vec r_{k-1}$</span> to <span class="arithmatex">$\vec r_{k-2}$</span> without crossing the line defined by <span class="arithmatex">$\vec r$</span>:</p>
<p><figure><img src="https://upload.wikimedia.org/wikipedia/commons/9/92/Continued_convergents_geometry.svg" width="700px"/>
<figcaption><em>Convergents of <span class="arithmatex">$r=\frac{7}{9}=[0;1,3,2]$</span>. Semiconvergents correspond to intermediate points between gray arrows.</em></figcaption></figure></p>
<p>On the picture above, <span class="arithmatex">$\vec r_2 = (4;3)$</span> is obtained by repeatedly adding <span class="arithmatex">$\vec r_1 = (1;1)$</span> to <span class="arithmatex">$\vec r_0 = (1;0)$</span>.</p>
<p>When it is not possible to further add <span class="arithmatex">$\vec r_1$</span> to <span class="arithmatex">$\vec r_0$</span> without crossing the <span class="arithmatex">$y=rx$</span> line, we go to the other side and repeatedly add <span class="arithmatex">$\vec r_2$</span> to <span class="arithmatex">$\vec r_1$</span> to obtain <span class="arithmatex">$\vec r_3 = (9;7)$</span>.</p>
<p>This procedure generates exponentially longer vectors, that approach the line.</p>
<p>For this property, the procedure of generating consequent convergent vectors was dubbed the <strong>nose stretching algorithm</strong> by Boris Delaunay.</p>
</div>
<p>If we look on the triangle drawn on points <span class="arithmatex">$\vec r_{k-2}$</span>, <span class="arithmatex">$\vec r_{k}$</span> and <span class="arithmatex">$\vec 0$</span> we will notice that its doubled area is</p>
<div class="arithmatex">$$|\vec r_{k-2} \times \vec r_k| = |\vec r_{k-2} \times (\vec r_{k-2} + a_k \vec r_{k-1})| = a_k |\vec r_{k-2} \times \vec r_{k-1}| = a_k.$$</div>
<p>Combined with the <a href="../geometry/picks-theorem.html">Pick's theorem</a>, it means that there are no lattice points strictly inside the triangle and the only lattice points on its border are <span class="arithmatex">$\vec 0$</span> and <span class="arithmatex">$\vec r_{k-2} + t \cdot \vec r_{k-1}$</span> for all integer <span class="arithmatex">$t$</span> such that <span class="arithmatex">$0 \leq t \leq a_k$</span>. When joined for all possible <span class="arithmatex">$k$</span> it means that there are no integer points in the space between polygons formed by even-indexed and odd-indexed convergent vectors.</p>
<p>This, in turn, means that <span class="arithmatex">$\vec r_k$</span> with odd coefficients form a convex hull of lattice points with <span class="arithmatex">$x \geq 0$</span> above the line <span class="arithmatex">$y=rx$</span>, while <span class="arithmatex">$\vec r_k$</span> with even coefficients form a convex hull of lattice points with <span class="arithmatex">$x &gt; 0$</span> below the line <span class="arithmatex">$y=rx$</span>.</p>
<div class="admonition info">
<p class="admonition-title">Definition</p>
<p>These polygons are also known as <strong>Klein polygons</strong>, named after Felix Klein who first suggested this geometric interpretation to the continued fractions.</p>
</div>
<h2 id="problem-examples">Problem examples<a class="headerlink" href="#problem-examples" title="Permanent link">&para;</a></h2>
<p>Now that the most important facts and concepts were introduced, it is time to delve into specific problem examples.</p>
<div class="admonition example">
<p class="admonition-title">Convex hull under the line</p>
<p>Find the convex hull of lattice points <span class="arithmatex">$(x;y)$</span> such that <span class="arithmatex">$0 \leq x \leq N$</span> and <span class="arithmatex">$0 \leq y \leq rx$</span> for <span class="arithmatex">$r=[a_0;a_1,\dots,a_k]=\frac{p_k}{q_k}$</span>.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>If we were considering the unbounded set <span class="arithmatex">$0 \leq x$</span>, the upper convex hull would be given by the line <span class="arithmatex">$y=rx$</span> itself.</p>
<p>However, with additional constraint <span class="arithmatex">$x \leq N$</span> we'd need to eventually deviate from the line to maintain proper convex hull.</p>
<p>Let <span class="arithmatex">$t = \lfloor \frac{N}{q_k}\rfloor$</span>, then first <span class="arithmatex">$t$</span> lattice points on the hull after <span class="arithmatex">$(0;0)$</span> are <span class="arithmatex">$\alpha \cdot (q_k; p_k)$</span> for integer <span class="arithmatex">$1 \leq \alpha \leq t$</span>.</p>
<p>However <span class="arithmatex">$(t+1)(q_k; p_k)$</span> can't be next lattice point since <span class="arithmatex">$(t+1)q_k$</span> is greater than <span class="arithmatex">$N$</span>.</p>
<p>To get to the next lattice points in the hull, we should get to the point <span class="arithmatex">$(x;y)$</span> which diverges from <span class="arithmatex">$y=rx$</span> by the smallest margin, while maintaining <span class="arithmatex">$x \leq N$</span>.</p>
<p><figure><img src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Lattice-hull.svg" width="500px"/>
<figcaption>Convex hull of lattice points under <span class="arithmatex">$y=\frac{4}{7}x$</span> for <span class="arithmatex">$0 \leq x \leq 19$</span> consists of points <span class="arithmatex">$(0;0), (7;4), (14;8), (16;9), (18;10), (19;10)$</span>.</figcaption></figure></p>
<p>Let <span class="arithmatex">$(x; y)$</span> be the last current point in the convex hull. Then the next point <span class="arithmatex">$(x'; y')$</span> is such that <span class="arithmatex">$x' \leq N$</span> and <span class="arithmatex">$(x'; y') - (x; y) = (\Delta x; \Delta y)$</span> is as close to the line <span class="arithmatex">$y=rx$</span> as possible. In other words, <span class="arithmatex">$(\Delta x; \Delta y)$</span> maximizes <span class="arithmatex">$r \Delta x - \Delta y$</span> subject to <span class="arithmatex">$\Delta x \leq N - x$</span> and <span class="arithmatex">$\Delta y \leq r \Delta x$</span>.</p>
<p>Points like that lie on the convex hull of lattice points below <span class="arithmatex">$y=rx$</span>. In other words, <span class="arithmatex">$(\Delta x; \Delta y)$</span> must be a lower semiconvergent of <span class="arithmatex">$r$</span>.</p>
<p>That being said, <span class="arithmatex">$(\Delta x; \Delta y)$</span> is of form <span class="arithmatex">$(q_{i-1}; p_{i-1}) + t \cdot (q_i; p_i)$</span> for some odd number <span class="arithmatex">$i$</span> and <span class="arithmatex">$0 \leq t &lt; a_i$</span>.</p>
<p>To find such <span class="arithmatex">$i$</span>, we can traverse all possible <span class="arithmatex">$i$</span> starting from the largest one and use <span class="arithmatex">$t = \lfloor \frac{N-x-q_{i-1}}{q_i} \rfloor$</span> for <span class="arithmatex">$i$</span> such that <span class="arithmatex">$N-x-q_{i-1} \geq 0$</span>.</p>
<p>With <span class="arithmatex">$(\Delta x; \Delta y) = (q_{i-1}; p_{i-1}) + t \cdot (q_i; p_i)$</span>, the condition <span class="arithmatex">$\Delta y \leq r \Delta x$</span> would be preserved by semiconvergent properties.</p>
<p>And <span class="arithmatex">$t &lt; a_i$</span> would hold because we already exhausted semiconvergents obtained from <span class="arithmatex">$i+2$</span>, hence <span class="arithmatex">$x + q_{i-1} + a_i q_i = x+q_{i+1}$</span> is greater than <span class="arithmatex">$N$</span>.</p>
<p>Now that we may add <span class="arithmatex">$(\Delta x; \Delta y)$</span>, to <span class="arithmatex">$(x;y)$</span> for <span class="arithmatex">$k = \lfloor \frac{N-x}{\Delta x} \rfloor$</span> times before we exceed <span class="arithmatex">$N$</span>, after which we would try the next semiconvergent.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">C++</label><label for="__tabbed_9_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// returns [ah, ph, qh] such that points r[i]=(ph[i], qh[i]) constitute upper convex hull</span>
<span class="c1">// of lattice points on 0 &lt;= x &lt;= N and 0 &lt;= y &lt;= r * x, where r = [a0; a1, a2, ...]</span>
<span class="c1">// and there are ah[i]-1 integer points on the segment between r[i] and r[i+1]</span>
<span class="k">auto</span><span class="w"> </span><span class="n">hull</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">back</span><span class="p">();</span>
<span class="w">    </span><span class="n">vector</span><span class="w"> </span><span class="n">ah</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">t</span><span class="p">};</span>
<span class="w">    </span><span class="n">vector</span><span class="w"> </span><span class="n">ph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="o">*</span><span class="n">p</span><span class="p">.</span><span class="n">back</span><span class="p">()};</span>
<span class="w">    </span><span class="n">vector</span><span class="w"> </span><span class="n">qh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="p">.</span><span class="n">back</span><span class="p">()};</span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">while</span><span class="p">(</span><span class="n">qh</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">qh</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">dq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">qh</span><span class="p">.</span><span class="n">back</span><span class="p">())</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dq</span><span class="p">;</span>
<span class="w">                </span><span class="n">ah</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
<span class="w">                </span><span class="n">ph</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ph</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dp</span><span class="p">);</span>
<span class="w">                </span><span class="n">qh</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">qh</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dq</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">make_tuple</span><span class="p">(</span><span class="n">ah</span><span class="p">,</span><span class="w"> </span><span class="n">ph</span><span class="p">,</span><span class="w"> </span><span class="n">qh</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># returns [ah, ph, qh] such that points r[i]=(ph[i], qh[i]) constitute upper convex hull</span>
<span class="c1"># of lattice points on 0 &lt;= x &lt;= N and 0 &lt;= y &lt;= r * x, where r = [a0; a1, a2, ...]</span>
<span class="c1"># and there are ah[i]-1 integer points on the segment between r[i] and r[i+1]</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hull</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ah</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="n">ph</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">qh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">))):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">//</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">dp</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">dq</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">//</span> <span class="n">dq</span>
                <span class="n">ah</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="n">ph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ph</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">dp</span><span class="p">)</span>
                <span class="n">qh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">dq</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ah</span><span class="p">,</span> <span class="n">ph</span><span class="p">,</span> <span class="n">qh</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://timus.online/problem.aspx?space=1&amp;num=1430">Timus - Crime and Punishment</a></p>
<p>You're given integer numbers <span class="arithmatex">$A$</span>, <span class="arithmatex">$B$</span> and <span class="arithmatex">$N$</span>. Find <span class="arithmatex">$x \geq 0$</span> and <span class="arithmatex">$y \geq 0$</span> such that <span class="arithmatex">$Ax + By \leq N$</span> and <span class="arithmatex">$Ax + By$</span> is the maximum possible.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>In this problem it holds that <span class="arithmatex">$1 \leq A, B, N \leq 2 \cdot 10^9$</span>, so it can be solved in <span class="arithmatex">$O(\sqrt N)$</span>. However, there is <span class="arithmatex">$O(\log N)$</span> solution with continued fractions.</p>
<p>For our convenience, we will invert the direction of <span class="arithmatex">$x$</span> by doing a substitution <span class="arithmatex">$x \mapsto \lfloor \frac{N}{A}\rfloor - x$</span>, so that now we need to find the point <span class="arithmatex">$(x; y)$</span> such that <span class="arithmatex">$0 \leq x \leq \lfloor \frac{N}{A} \rfloor$</span>, <span class="arithmatex">$By - Ax \leq N \;\bmod\; A$</span> and <span class="arithmatex">$By - Ax$</span> is the maximum possible. Optimal <span class="arithmatex">$y$</span> for each <span class="arithmatex">$x$</span> has a value of <span class="arithmatex">$\lfloor \frac{Ax + (N \bmod A)}{B} \rfloor$</span>.</p>
<p>To treat it more generically, we will write a function that finds the best point on <span class="arithmatex">$0 \leq x \leq N$</span> and <span class="arithmatex">$y = \lfloor \frac{Ax+B}{C} \rfloor$</span>.</p>
<p>Core solution idea in this problem essentially repeats the previous problem, but instead of using lower semiconvergents to diverge from line, you use upper semiconvergents to get closer to the line without crossing it and without violating <span class="arithmatex">$x \leq N$</span>. Unfortunately, unlike the previous problem, you need to make sure that you don't cross the <span class="arithmatex">$y=\frac{Ax+B}{C}$</span> line while getting closer to it, so you should keep it in mind when calculating semiconvergent's coefficient <span class="arithmatex">$t$</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:1"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># (x, y) such that y = (A*x+B) // C,</span>
<span class="c1"># Cy - Ax is max and 0 &lt;= x &lt;= N.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">closest</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="c1"># y &lt;= (A*x + B)/C &lt;=&gt; diff(x, y) &lt;= B</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">C</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">A</span><span class="o">*</span><span class="n">x</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">fraction</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">ph</span> <span class="o">=</span> <span class="p">[</span><span class="n">B</span> <span class="o">//</span> <span class="n">C</span><span class="p">]</span>
    <span class="n">qh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">diff</span><span class="p">(</span><span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">ph</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">B</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ph</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">B</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="nb">abs</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">dp</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">dq</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">//</span> <span class="n">dq</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ph</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">diff</span><span class="p">(</span><span class="n">dq</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">k</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="n">diff</span><span class="p">(</span><span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ph</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">//</span> <span class="n">diff</span><span class="p">(</span><span class="n">dq</span><span class="p">,</span> <span class="n">dp</span><span class="p">))</span>
                <span class="n">qh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">dq</span><span class="p">)</span>
                <span class="n">ph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ph</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">dp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ph</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">closest</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">N</span> <span class="o">%</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">N</span> <span class="o">//</span> <span class="n">A</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">N</span> <span class="o">//</span> <span class="n">A</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://www.codechef.com/problems/ES">June Challenge 2017 - Euler Sum</a></p>
<p>Compute <span class="arithmatex">$\sum\limits_{x=1}^N \lfloor ex \rfloor$</span>, where <span class="arithmatex">$e = [2; 1, 2, 1, 1, 4, 1, 1, 6, 1, \dots, 1, 2n, 1, \dots]$</span> is the Euler's number and <span class="arithmatex">$N \leq 10^{4000}$</span>.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>This sum is equal to the number of lattice point <span class="arithmatex">$(x;y)$</span> such that <span class="arithmatex">$1 \leq x \leq N$</span> and <span class="arithmatex">$1 \leq y \leq ex$</span>.    </p>
<p>After constructing the convex hull of the points below <span class="arithmatex">$y=ex$</span>, this number can be computed using <a href="../geometry/picks-theorem.html">Pick's theorem</a>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">C++</label><label for="__tabbed_11_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// sum floor(k * x) for k in [1, N] and x = [a0; a1, a2, ...]</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">sum_floor</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">N</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">ah</span><span class="p">,</span><span class="w"> </span><span class="n">ph</span><span class="p">,</span><span class="w"> </span><span class="n">qh</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hull</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// The number of lattice points within a vertical right trapezoid</span>
<span class="w">    </span><span class="c1">// on points (0; 0) - (0; y1) - (dx; y2) - (dx; 0) that has</span>
<span class="w">    </span><span class="c1">// a+1 integer points on the segment (0; y1) - (dx; y2).</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">picks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[](</span><span class="kt">int</span><span class="w"> </span><span class="n">y1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y2</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dx</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">y1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dx</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">y2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">qh</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ans</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">picks</span><span class="p">(</span><span class="n">ph</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">ph</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">qh</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">qh</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">ah</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ans</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">N</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># sum floor(k * x) for k in [1, N] and x = [a0; a1, a2, ...]</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sum_floor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">ah</span><span class="p">,</span> <span class="n">ph</span><span class="p">,</span> <span class="n">qh</span> <span class="o">=</span> <span class="n">hull</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

    <span class="c1"># The number of lattice points within a vertical right trapezoid</span>
    <span class="c1"># on points (0; 0) - (0; y1) - (dx; y2) - (dx; 0) that has</span>
    <span class="c1"># a+1 integer points on the segment (0; y1) - (dx; y2).</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">picks</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="n">dx</span>
        <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span> <span class="o">+</span> <span class="n">y2</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">-</span> <span class="p">(</span><span class="n">y2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">qh</span><span class="p">)):</span>
        <span class="n">ans</span> <span class="o">+=</span> <span class="n">picks</span><span class="p">(</span><span class="n">ph</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ph</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">qh</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">qh</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ah</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">ans</span> <span class="o">-</span> <span class="n">N</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://open.kattis.com/problems/itsamodmodmodmodworld">NAIPC 2019 - It's a Mod, Mod, Mod, Mod World</a></p>
<p>Given <span class="arithmatex">$p$</span>, <span class="arithmatex">$q$</span> and <span class="arithmatex">$n$</span>, compute <span class="arithmatex">$\sum\limits_{i=1}^n [p \cdot i \bmod q]$</span>.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>This problem reduces to the previous one if you note that <span class="arithmatex">$a \bmod b = a - \lfloor \frac{a}{b} \rfloor b$</span>. With this fact, the sum reduces to</p>
<div class="arithmatex">$$\sum\limits_{i=1}^n \left(p \cdot i - \left\lfloor \frac{p \cdot i}{q} \right\rfloor q\right) = \frac{pn(n+1)}{2}-q\sum\limits_{i=1}^n \left\lfloor \frac{p \cdot i}{q}\right\rfloor.$$</div>
<p>However, summing up <span class="arithmatex">$\lfloor rx \rfloor$</span> for <span class="arithmatex">$x$</span> from <span class="arithmatex">$1$</span> to <span class="arithmatex">$N$</span> is something that we're capable of from the previous problem.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">C++</label><label for="__tabbed_12_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sum_floor</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">),</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">q</span> <span class="o">*</span> <span class="n">sum_floor</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://judge.yosupo.jp/problem/sum_of_floor_of_linear">Library Checker - Sum of Floor of Linear</a></p>
<p>Given <span class="arithmatex">$N$</span>, <span class="arithmatex">$M$</span>, <span class="arithmatex">$A$</span> and <span class="arithmatex">$B$</span>, compute <span class="arithmatex">$\sum\limits_{i=0}^{N-1} \lfloor \frac{A \cdot i + B}{M} \rfloor$</span>.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>This is the most technically troublesome problem so far.</p>
<p>It is possible to use the same approach and construct the full convex hull of points below the line <span class="arithmatex">$y = \frac{Ax+B}{M}$</span>.</p>
<p>We already know how to solve it for <span class="arithmatex">$B = 0$</span>. Moreover, we already know how to construct this convex hull up to the closest lattice point to this line on <span class="arithmatex">$[0, N-1]$</span> segment (this is done in the "Crime and Punishment" problem above.</p>
<p>Now we should note that once we reached the closest point to the line, we can just assume that the line in fact passes through the closest point, as there are no other lattice points on <span class="arithmatex">$[0, N-1]$</span> in between the actual line and the line moved slightly below to pass through the closest point.</p>
<p>That being said, to construct the full convex hull below the line <span class="arithmatex">$y=\frac{Ax+B}{M}$</span> on <span class="arithmatex">$[0, N-1]$</span>, we can construct it up to the closest point to the line on <span class="arithmatex">$[0, N-1]$</span> and then continue as if the line passes through this point, reusing algorithm for constructing convex hull with <span class="arithmatex">$B=0$</span>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:1"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># hull of lattice (x, y) such that C*y &lt;= A*x+B</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hull</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">C</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">A</span><span class="o">*</span><span class="n">x</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">fraction</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">ah</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ph</span> <span class="o">=</span> <span class="p">[</span><span class="n">B</span> <span class="o">//</span> <span class="n">C</span><span class="p">]</span>
    <span class="n">qh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="n">dq</span><span class="p">,</span> <span class="n">dp</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">//</span> <span class="n">dq</span>
        <span class="k">if</span> <span class="n">diff</span><span class="p">(</span><span class="n">dq</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="n">diff</span><span class="p">(</span><span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ph</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">//</span> <span class="n">diff</span><span class="p">(</span><span class="n">dq</span><span class="p">,</span> <span class="n">dp</span><span class="p">))</span>
        <span class="n">ah</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">qh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">dq</span><span class="p">)</span>
        <span class="n">ph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ph</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">dp</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">diff</span><span class="p">(</span><span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">ph</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">B</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="n">diff</span><span class="p">(</span><span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">ph</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="o">//</span> <span class="nb">abs</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">dp</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">dq</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">dq</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dq</span> <span class="o">&gt;</span> <span class="n">N</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">insert</span><span class="p">(</span><span class="n">dq</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>

    <span class="n">insert</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">))):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">qh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">//</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">dp</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">dq</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">insert</span><span class="p">(</span><span class="n">dq</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ah</span><span class="p">,</span> <span class="n">ph</span><span class="p">,</span> <span class="n">qh</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition example">
<p class="admonition-title"><a href="https://codeforces.com/gym/102354/problem/I">OKC 2 - From Modular to Rational</a></p>
<p>There is a rational number <span class="arithmatex">$\frac{p}{q}$</span> such that <span class="arithmatex">$1 \leq p, q \leq 10^9$</span>. You may ask the value of <span class="arithmatex">$p q^{-1}$</span> modulo <span class="arithmatex">$m \sim 10^9$</span> for several prime numbers <span class="arithmatex">$m$</span>. Recover <span class="arithmatex">$\frac{p}{q}$</span>.</p>
<p><em>Equivalent formulation:</em> Find <span class="arithmatex">$x$</span> that delivers the minimum of <span class="arithmatex">$Ax \;\bmod\; M$</span> for <span class="arithmatex">$1 \leq x \leq N$</span>.</p>
</div>
<details class="hint">
<summary>Solution</summary>
<p>Due to Chinese remainder theorem, asking the result modulo several prime numbers is the same as asking it modulo their product. Due to this, without loss of generality we'll assume that we know the remainder modulo sufficiently large number <span class="arithmatex">$m$</span>.</p>
<p>There could be several possible solutions <span class="arithmatex">$(p, q)$</span> to <span class="arithmatex">$p \equiv qr \pmod m$</span> for a given remainder <span class="arithmatex">$r$</span>. However, if <span class="arithmatex">$(p_1, q_1)$</span> and <span class="arithmatex">$(p_2, q_2)$</span> are both the solutions then it also holds that <span class="arithmatex">$p_1 q_2 \equiv p_2 q_1 \pmod m$</span>. Assuming that <span class="arithmatex">$\frac{p_1}{q_1} \neq \frac{p_2}{q_2}$</span> it means that <span class="arithmatex">$|p_1 q_2 - p_2 q_1|$</span> is at least <span class="arithmatex">$m$</span>.</p>
<p>In the statement we were told that <span class="arithmatex">$1 \leq p, q \leq 10^9$</span>, so if both <span class="arithmatex">$p_1, q_1$</span> and <span class="arithmatex">$p_2, q_2$</span> are at most <span class="arithmatex">$10^9$</span>, then the difference is at most <span class="arithmatex">$10^{18}$</span>. For <span class="arithmatex">$m &gt; 10^{18}$</span> it means that the solution <span class="arithmatex">$\frac{p}{q}$</span> with <span class="arithmatex">$1 \leq p, q \leq 10^9$</span> is unique, as a rational number.</p>
<p>So, the problem boils down, given <span class="arithmatex">$r$</span> modulo <span class="arithmatex">$m$</span>, to finding any <span class="arithmatex">$q$</span> such that <span class="arithmatex">$1 \leq q \leq 10^9$</span> and <span class="arithmatex">$qr \;\bmod\; m \leq 10^9$</span>.</p>
<p>This is effectively the same as finding <span class="arithmatex">$q$</span> that delivers the minimum possible <span class="arithmatex">$qr \bmod m$</span> for <span class="arithmatex">$1 \leq q \leq 10^9$</span>.</p>
<p>For <span class="arithmatex">$qr = km + b$</span> it means that we need to find a pair <span class="arithmatex">$(q, m)$</span> such that <span class="arithmatex">$1 \leq q \leq 10^9$</span> and <span class="arithmatex">$qr - km \geq 0$</span> is the minimum possible.</p>
<p>Since <span class="arithmatex">$m$</span> is constant, we can divide by it and further restate it as find <span class="arithmatex">$q$</span> such that <span class="arithmatex">$1 \leq q \leq 10^9$</span> and <span class="arithmatex">$\frac{r}{m} q - k \geq 0$</span> is the minimum possible.</p>
<p>In terms of continued fractions it means that <span class="arithmatex">$\frac{k}{q}$</span> is the best diophantine approximation to <span class="arithmatex">$\frac{r}{m}$</span> and it is sufficient to only check lower semiconvergents of <span class="arithmatex">$\frac{r}{m}$</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:1"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># find Q that minimizes Q*r mod m for 1 &lt;= k &lt;= n &lt; m </span>
<span class="k">def</span><span class="w"> </span><span class="nf">mod_min</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">fraction</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">convergents</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="ow">or</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">//</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="practice-problems">Practice problems<a class="headerlink" href="#practice-problems" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=775">UVa OJ - Continued Fractions</a></li>
<li><a href="https://www.hackerrank.com/contests/projecteuler/challenges/euler064/problem">ProjectEuler+ #64: Odd period square roots</a></li>
<li><a href="https://codeforces.com/contest/305/problem/B">Codeforces Round #184 (Div. 2) - Continued Fractions</a></li>
<li><a href="https://codeforces.com/contest/346/problem/E">Codeforces Round #201 (Div. 1) - Doodle Jump</a></li>
<li><a href="https://codeforces.com/contest/585/problem/C">Codeforces Round #325 (Div. 1) - Alice, Bob, Oranges and Apples</a></li>
<li><a href="http://poj.org/problem?id=3530">POJ Founder Monthly Contest 2008.03.16 - A Modular Arithmetic Challenge</a></li>
<li><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6624">2019 Multi-University Training Contest 5 - fraction</a></li>
<li><a href="https://www.codechef.com/SNCKEL19/problems/EBAIT">SnackDown 2019 Elimination Round - Election Bait</a></li>
<li><a href="https://github.com/google/coding-competitions-archive/blob/main/codejam/2019/round_2/new_elements_part_2/statement.pdf">Code Jam 2019 round 2 - Continued Fraction</a></li>
</ul>

<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
  <span class="contributors-text">Contributors:</span>
  <ul class="contributors" data-bi-name="contributors"><li><a href="https://github.com/adamant-pwn" title="adamant-pwn" data-bi-name="contributorprofile" target="_blank">adamant-pwn</a> (99.91%)</li><li><a href="https://github.com/jatingaur18" title="jatingaur18" data-bi-name="contributorprofile" target="_blank">jatingaur18</a> (0.09%)</li></ul>
</ul>
                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      

<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Text is available under the <a href="https://github.com/cp-algorithms/cp-algorithms/blob/main/LICENSE">Creative Commons Attribution Share Alike 4.0 International</a> License<br/>Copyright &copy; 2014 - 2025 by <a href="https://github.com/cp-algorithms/cp-algorithms/graphs/contributors">cp-algorithms contributors</a>
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      <div class="md-social">
  
</div>
    </div>
  </div>
</footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "search.suggest", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="../javascript/config.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../assets/javascripts/toggle-sidebar.js" async></script>
      
    
  </body>
</html>