
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The goal of this project is to translate the wonderful resource http://e-maxx.ru/algo which provides descriptions of many algorithms and data structures especially popular in field of competitive programming. Moreover we want to improve the collected knowledge by extending the articles and adding new articles to the collection.">
      
      
      
        <link rel="canonical" href="https://cp-algorithms.com/string/suffix-automaton.html">
      
      
        <link rel="prev" href="suffix-tree-ukkonen.html">
      
      
        <link rel="next" href="lyndon_factorization.html">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../feed_rss_updated.xml">
      
      <link rel="icon" href="../favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Suffix Automaton - Algorithms for Competitive Programming</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-7FLS2HCYHH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-7FLS2HCYHH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-7FLS2HCYHH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="cpalgo" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#suffix-automaton" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!-- overwrite:
- scroll to top when clicking title
- go to main page when clicking the site title
-->


<header class="md-header" data-md-component="header">
  <script>
    function scrollToTop() {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    }
  </script>
  <nav class="md-header__inner md-grid" aria-label="header.title">
    <a href=".." title="Algorithms for Competitive Programming" class="md-header__button md-logo" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
      
  <img src="../favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            <a href=".." title="Algorithms for Competitive Programming" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
              Algorithms for Competitive Programming
            </a>
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            <a href="#" onclick="scrollToTop()">
              
                Suffix Automaton
              
            </a>
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="cpalgo" data-md-color-primary="deep-purple" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/cp-algorithms/cp-algorithms" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    cp-algorithms/cp-algorithms
  </div>
</a>
      </div>
    
      <div class="rss icon">
      <a href="https://cp-algorithms.com/feed_rss_created.xml" title="RSS" class="md-content__button md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 64c0-17.7 14.3-32 32-32 229.8 0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7 0 64m0 352a64 64 0 1 1 128 0 64 64 0 1 1-128 0m32-256c159.1 0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7 0-32-14.3-32-32s14.3-32 32-32"/></svg>
      </a>
      </div>

    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Algorithms for Competitive Programming" class="md-nav__button md-logo" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
      
  <img src="../favicon.ico" alt="logo">

    </a>
    Algorithms for Competitive Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cp-algorithms/cp-algorithms" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    cp-algorithms/cp-algorithms
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Main Page
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../navigation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Navigation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tags.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tag index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contrib.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to Contribute
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code_of_conduct.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of conduct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Preview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Algebra
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Algebra
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/binary-exp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Binary Exponentiation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/euclid-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Euclidean algorithm for computing the greatest common divisor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/extended-euclid-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extended Euclidean Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/linear-diophantine-equation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linear Diophantine Equations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/fibonacci-numbers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fibonacci Numbers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Prime numbers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Prime numbers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/sieve-of-eratosthenes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sieve of Eratosthenes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/prime-sieve-linear.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linear Sieve
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/primality_tests.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Primality tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/factorization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integer factorization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Number-theoretic functions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Number-theoretic functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/phi-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Euler's totient function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/divisors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Number of divisors / sum of divisors
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Modular arithmetic
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Modular arithmetic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/module-inverse.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modular Inverse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/linear_congruence_equation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linear Congruence Equation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/chinese-remainder-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chinese Remainder Theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/garners-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Garner's Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/factorial-modulo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Factorial modulo p
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/discrete-log.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Discrete Log
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/primitive-root.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Primitive Root
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/discrete-root.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Discrete Root
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/montgomery_multiplication.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Montgomery Multiplication
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Number systems
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Number systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/balanced-ternary.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Balanced Ternary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/gray-code.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gray code
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/bit-manipulation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bit manipulation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/all-submasks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enumerating submasks of a bitmask
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/big-integer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Arbitrary-Precision Arithmetic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/fft.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fast Fourier transform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/polynomial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operations on polynomials and series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/continued-fractions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Continued fractions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/factoring-exp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Factoring Exponentiation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data Structures
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Data Structures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/stack_queue_modification.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimum Stack / Minimum Queue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sparse-table.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sparse Table
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Trees
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Trees
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/disjoint_set_union.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Disjoint Set Union
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/fenwick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fenwick Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sqrt_decomposition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sqrt Decomposition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/segment_tree.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Segment Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/treap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Treap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sqrt-tree.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sqrt Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/randomized_heap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Randomized Heap
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/deleting_in_log_n.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deleting from a data structure in O(T(n) log n)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Dynamic Programming
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Dynamic Programming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/intro-to-dp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Dynamic Programming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/knapsack.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knapsack Problem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    DP optimizations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            DP optimizations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/divide-and-conquer-dp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Divide and Conquer DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/knuth-optimization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knuth's Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/profile-dynamics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dynamic Programming on Broken Profile. Problem "Parquet"
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/zero_matrix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding the largest zero submatrix
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    String Processing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            String Processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="string-hashing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    String Hashing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="rabin-karp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rabin-Karp for String Matching
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="prefix-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prefix function - Knuth-Morris-Pratt
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="z-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Z-function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="suffix-array.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Suffix Array
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="aho_corasick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Aho-Corasick algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="suffix-tree-ukkonen.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Suffix Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Suffix Automaton
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="suffix-automaton.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Suffix Automaton
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#definition-of-a-suffix-automaton" class="md-nav__link">
    <span class="md-ellipsis">
      Definition of a suffix automaton
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Definition of a suffix automaton">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#substring-property" class="md-nav__link">
    <span class="md-ellipsis">
      Substring property
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples-of-constructed-suffix-automata" class="md-nav__link">
    <span class="md-ellipsis">
      Examples of constructed suffix automata
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#construction-in-linear-time" class="md-nav__link">
    <span class="md-ellipsis">
      Construction in linear time
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Construction in linear time">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#end-positions-endpos" class="md-nav__link">
    <span class="md-ellipsis">
      End positions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suffix-links-link" class="md-nav__link">
    <span class="md-ellipsis">
      Suffix links
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recap" class="md-nav__link">
    <span class="md-ellipsis">
      Recap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correctness" class="md-nav__link">
    <span class="md-ellipsis">
      Correctness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linear-number-of-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Linear number of operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Additional properties
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Additional properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#number-of-states" class="md-nav__link">
    <span class="md-ellipsis">
      Number of states
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#number-of-transitions" class="md-nav__link">
    <span class="md-ellipsis">
      Number of transitions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#applications" class="md-nav__link">
    <span class="md-ellipsis">
      Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-for-occurrence" class="md-nav__link">
    <span class="md-ellipsis">
      Check for occurrence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#number-of-different-substrings" class="md-nav__link">
    <span class="md-ellipsis">
      Number of different substrings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#total-length-of-all-different-substrings" class="md-nav__link">
    <span class="md-ellipsis">
      Total length of all different substrings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lexicographically-k-th-substring" class="md-nav__link">
    <span class="md-ellipsis">
      Lexicographically k-th substring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallest-cyclic-shift" class="md-nav__link">
    <span class="md-ellipsis">
      Smallest cyclic shift
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#number-of-occurrences" class="md-nav__link">
    <span class="md-ellipsis">
      Number of occurrences
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#first-occurrence-position" class="md-nav__link">
    <span class="md-ellipsis">
      First occurrence position
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#all-occurrence-positions" class="md-nav__link">
    <span class="md-ellipsis">
      All occurrence positions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shortest-non-appearing-string" class="md-nav__link">
    <span class="md-ellipsis">
      Shortest non-appearing string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#longest-common-substring-of-two-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Longest common substring of two strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#largest-common-substring-of-multiple-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Largest common substring of multiple strings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practice-problems" class="md-nav__link">
    <span class="md-ellipsis">
      Practice Problems
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lyndon_factorization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lyndon factorization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="expression_parsing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Expression parsing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="manacher.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manacher's Algorithm - Finding all sub-palindromes in O(N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="main_lorentz.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding repetitions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linear Algebra
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Linear Algebra
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Matrices
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Matrices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/linear-system-gauss.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gauss & System of Linear Equations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/determinant-gauss.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gauss & Determinant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/determinant-kraut.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kraut & Determinant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/rank-matrix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rank of a matrix
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Combinatorics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Combinatorics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/factorial-divisors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Power of Factorial Divisor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/binomial-coefficients.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Binomial Coefficients
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/catalan-numbers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Catalan Numbers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Techniques
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Techniques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/inclusion-exclusion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Inclusion-Exclusion Principle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/burnside.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Burnside's lemma / Plya enumeration theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/stars_and_bars.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stars and bars
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/generating_combinations.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generating all K-combinations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/bishops-on-chessboard.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Placing Bishops on a Chessboard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/bracket_sequences.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Balanced bracket sequences
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combinatorics/counting_labeled_graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Counting labeled graphs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Numerical Methods
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Numerical Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" >
        
          
          <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Search
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            Search
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/binary_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Binary Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/ternary_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ternary Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/roots_newton.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Newton's method for finding roots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/simulated_annealing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simulated Annealing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Integration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/simpson-integration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integration by Simpson's formula
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Geometry
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Geometry
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1" >
        
          
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Elementary operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            Elementary operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/basic-geometry.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Geometry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/segment-to-line.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding the equation of a line for a segment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/lines-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intersection Point of Lines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/check-segments-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Check if two segments intersect
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/segments-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intersection of Segments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/circle-line-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Circle-Line Intersection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/circle-circle-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Circle-Circle Intersection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/tangents-to-two-circles.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common tangents to two circles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/length-of-segments-union.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Length of the union of segments
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2" >
        
          
          <label class="md-nav__link" for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Polygons
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            Polygons
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/oriented-triangle-area.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Oriented area of a triangle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/area-of-simple-polygon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Area of simple polygon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/point-in-convex-polygon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Check if points belong to the convex polygon in O(log N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/minkowski.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minkowski sum of convex polygons
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/picks-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pick's Theorem - area of lattice polygons
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/lattice-points.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lattice points of non-lattice polygon
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Convex hull
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            Convex hull
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/convex-hull.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convex hull construction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/convex_hull_trick.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convex hull trick and Li Chao tree
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_4" >
        
          
          <label class="md-nav__link" for="__nav_9_4" id="__nav_9_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sweep-line
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_4">
            <span class="md-nav__icon md-icon"></span>
            Sweep-line
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/intersecting_segments.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Search for a pair of intersecting segments
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_5" >
        
          
          <label class="md-nav__link" for="__nav_9_5" id="__nav_9_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Planar graphs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_5">
            <span class="md-nav__icon md-icon"></span>
            Planar graphs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/planar.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding faces of a planar graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/point-location.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Point location in O(log N)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_6" >
        
          
          <label class="md-nav__link" for="__nav_9_6" id="__nav_9_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_6">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/nearest_points.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding the nearest pair of points
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/delaunay.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Delaunay triangulation and Voronoi diagram
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/vertical_decomposition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vertical decomposition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/halfplane-intersection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Half-plane intersection - S&I Algorithm in O(N log N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/manhattan-distance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manhattan Distance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Graphs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Graphs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_1" >
        
          
          <label class="md-nav__link" for="__nav_10_1" id="__nav_10_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Graph traversal
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_1">
            <span class="md-nav__icon md-icon"></span>
            Graph traversal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/breadth-first-search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Breadth First Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/depth-first-search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Depth First Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_2" >
        
          
          <label class="md-nav__link" for="__nav_10_2" id="__nav_10_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Connected components, bridges, articulations points
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_2">
            <span class="md-nav__icon md-icon"></span>
            Connected components, bridges, articulations points
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/search-for-connected-components.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Connected Components
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bridge-searching.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Bridges in O(N+M)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bridge-searching-online.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Bridges Online
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/cutpoints.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Articulation Points in O(N+M)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/strongly-connected-components.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strongly Connected Components and Condensation Graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/strong-orientation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strong Orientation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_3" >
        
          
          <label class="md-nav__link" for="__nav_10_3" id="__nav_10_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Single-source shortest paths
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_3">
            <span class="md-nav__icon md-icon"></span>
            Single-source shortest paths
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dijkstra.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dijkstra - finding shortest paths from given vertex
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dijkstra_sparse.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dijkstra on sparse graphs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bellman_ford.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bellman-Ford - finding shortest paths with negative weights
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/01_bfs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0-1 BFS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/desopo_pape.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DEsopo-Pape algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_4" >
        
          
          <label class="md-nav__link" for="__nav_10_4" id="__nav_10_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    All-pairs shortest paths
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_4">
            <span class="md-nav__icon md-icon"></span>
            All-pairs shortest paths
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/all-pair-shortest-path-floyd-warshall.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Floyd-Warshall - finding all shortest paths
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/fixed_length_paths.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Number of paths of fixed length / Shortest paths of fixed length
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_5" >
        
          
          <label class="md-nav__link" for="__nav_10_5" id="__nav_10_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Spanning trees
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_5">
            <span class="md-nav__icon md-icon"></span>
            Spanning trees
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_prim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimum Spanning Tree - Prim's Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_kruskal.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimum Spanning Tree - Kruskal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_kruskal_with_dsu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimum Spanning Tree - Kruskal with Disjoint Set Union
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/second_best_mst.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Second best Minimum Spanning Tree - Using Kruskal and Lowest Common Ancestor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/kirchhoff-theorem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kirchhoff Theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/pruefer_code.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prfer code
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_6" >
        
          
          <label class="md-nav__link" for="__nav_10_6" id="__nav_10_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cycles
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_6">
            <span class="md-nav__icon md-icon"></span>
            Cycles
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/finding-cycle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Checking a graph for acyclicity and finding a cycle in O(M)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/finding-negative-cycle-in-graph.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding a Negative Cycle in the Graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/euler_path.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Eulerian Path
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_7" >
        
          
          <label class="md-nav__link" for="__nav_10_7" id="__nav_10_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Lowest common ancestor
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_7">
            <span class="md-nav__icon md-icon"></span>
            Lowest common ancestor
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lowest Common Ancestor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_binary_lifting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lowest Common Ancestor - Binary Lifting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_farachcoltonbender.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lowest Common Ancestor - Farach-Colton and Bender algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/rmq_linear.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solve RMQ by finding LCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_tarjan.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lowest Common Ancestor - Tarjan's off-line algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_8" >
        
          
          <label class="md-nav__link" for="__nav_10_8" id="__nav_10_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Flows and related problems
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_8">
            <span class="md-nav__icon md-icon"></span>
            Flows and related problems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/edmonds_karp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maximum flow - Ford-Fulkerson and Edmonds-Karp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/push-relabel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maximum flow - Push-relabel algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/push-relabel-faster.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maximum flow - Push-relabel algorithm improved
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dinic.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maximum flow - Dinic's algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mpm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maximum flow - MPM algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/flow_with_demands.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flows with demands
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/min_cost_flow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimum-cost flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/Assignment-problem-min-flow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment problem
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_9" >
        
          
          <label class="md-nav__link" for="__nav_10_9" id="__nav_10_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Matchings and related problems
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_9">
            <span class="md-nav__icon md-icon"></span>
            Matchings and related problems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bipartite-check.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bipartite Graph Check
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/kuhn_maximum_bipartite_matching.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kuhn's Algorithm - Maximum Bipartite Matching
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/hungarian-algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hungarian Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_10" >
        
          
          <label class="md-nav__link" for="__nav_10_10" id="__nav_10_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_10">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/topological-sort.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Topological Sorting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/edge_vertex_connectivity.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Edge connectivity / Vertex connectivity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/tree_painting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tree painting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/2SAT.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2-SAT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/hld.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heavy-light decomposition
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1" >
        
          
          <label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sequences
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1">
            <span class="md-nav__icon md-icon"></span>
            Sequences
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/rmq.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RMQ task (Range Minimum Query - the smallest element in an interval)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/longest_increasing_subsequence.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Longest increasing subsequence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/maximum_average_segment.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Search the subsegment with the maximum/minimum sum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/k-th.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    K-th order statistic in O(N)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/mex.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MEX task (Minimal Excluded element in an array)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Game Theory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            Game Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game_theory/games_on_graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Games on arbitrary graphs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game_theory/sprague-grundy-nim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sprague-Grundy theorem. Nim
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Schedules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            Schedules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule_one_machine.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scheduling jobs on one machine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule_two_machines.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scheduling jobs on two machines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule-with-completion-duration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimal schedule of jobs given their deadlines and durations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_4" >
        
          
          <label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_4">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/tortoise_and_hare.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tortoise and Hare Algorithm (Linked List cycle detection)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/josephus_problem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Josephus problem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/15-puzzle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15 Puzzle Game: Existence Of The Solution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/stern_brocot_tree_farey_sequences.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Stern-Brocot Tree and Farey Sequences
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  <script type="text/javascript">
window.onload = function() {
	const newIssueURL = "https://github.com/cp-algorithms/cp-algorithms/issues/new";
  const issueTitle = "Problem on article " + "Suffix Automaton";
	const issueBody = `
 **Article:** [`+ "Suffix Automaton" + `](${window.location.href})

**Problem:**
<!--
Describe the issue of this article in detail.
-->
`;
  var issue_a = document.getElementById("report_issue_a");
  issue_a.href = `${newIssueURL}?` + `title=${encodeURIComponent(issueTitle)}&` + `body=${encodeURIComponent(issueBody)}`;
}
</script>

<a href="https://github.com/cp-algorithms/cp-algorithms/edit/main/src/string/suffix-automaton.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
</a>
<a id="report_issue_a" href="" title="Report a problem" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2z"/></svg>
</a>
<a href="https://github.com/cp-algorithms/cp-algorithms/commits/main/src/string/suffix-automaton.md" title="Page authors" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g><g><path d="M12,8.5c-0.91,0-2.75,0.46-2.75,1.38v4.62h1.5V19h2.5v-4.5h1.5V9.88C14.75,8.97,12.91,8.5,12,8.5z"/><path d="M12,2C6.47,2,2,6.47,2,12s4.47,10,10,10s10-4.48,10-10S17.52,2,12,2z M12,20c-4.42,0-8-3.58-8-8s3.58-8,8-8s8,3.58,8,8 S16.42,20,12,20z"/><circle cx="12" cy="6.5" r="1.5"/></g></g></g></svg>
</a>


<!-- Construct the dict of author's contribution percentage -->




  
  
  
    
  

  
  
  
    
  
    
  

  
  
  
    
  

  
  
  
    
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  
    
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  
    
  

  
  
  
    
  

  
  
  
    
  



  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  




<!-- Date of last commit -->
<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">

  Last update:
  <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="November 8, 2024 19:11:20 UTC">November 8, 2024</span>&emsp;

<!-- Tags -->

  
  
  
    
  


  
    <a href="../tags.html#tag:translated" class="md-tag">
      Translated
    </a>
  

  
    <a href="https://e-maxx.ru/algo/suffix_automata" class="md-tag">
      From: e-maxx.ru
    </a>
  

</ul>


<h1 id="suffix-automaton">Suffix Automaton<a class="headerlink" href="#suffix-automaton" title="Permanent link">&para;</a></h1>
<p>A <strong>suffix automaton</strong> is a powerful data structure that allows solving many string-related problems. </p>
<p>For example, you can search for all occurrences of one string in another, or count the amount of different substrings of a given string.
Both tasks can be solved in linear time with the help of a suffix automaton.</p>
<p>Intuitively a suffix automaton can be understood as a compressed form of <strong>all substrings</strong> of a given string.
An impressive fact is, that the suffix automaton contains all this information in a highly compressed form.
For a string of length <span class="arithmatex">$n$</span> it only requires <span class="arithmatex">$O(n)$</span> memory.
Moreover, it can also be built in <span class="arithmatex">$O(n)$</span> time (if we consider the size <span class="arithmatex">$k$</span> of the alphabet as a constant), otherwise both the memory and the time complexity will be <span class="arithmatex">$O(n \log k)$</span>.</p>
<p>The linearity of the size of the suffix automaton was first discovered in 1983 by Blumer et al., and in 1985 the first linear algorithms for the construction was presented by Crochemore and Blumer.</p>
<h2 id="definition-of-a-suffix-automaton">Definition of a suffix automaton<a class="headerlink" href="#definition-of-a-suffix-automaton" title="Permanent link">&para;</a></h2>
<p>A suffix automaton for a given string <span class="arithmatex">$s$</span> is a minimal <strong>DFA</strong> (deterministic finite automaton / deterministic finite state machine) that accepts all the suffixes of the string <span class="arithmatex">$s$</span>.</p>
<p>In other words:</p>
<ul>
<li>A suffix automaton is an oriented acyclic graph.
    The vertices are called <strong>states</strong>, and the edges are called <strong>transitions</strong> between states.</li>
<li>One of the states <span class="arithmatex">$t_0$</span> is the <strong>initial state</strong>, and it must be the source of the graph (all other states are reachable from <span class="arithmatex">$t_0$</span>).</li>
<li>Each <strong>transition</strong> is labeled with some character.
    All transitions originating from a state must have <strong>different</strong> labels.</li>
<li>One or multiple states are marked as <strong>terminal states</strong>.
    If we start from the initial state <span class="arithmatex">$t_0$</span> and move along transitions to a terminal state, then the labels of the passed transitions must spell one of the suffixes of the string <span class="arithmatex">$s$</span>.
    Each of the suffixes of <span class="arithmatex">$s$</span> must be spellable using a path from <span class="arithmatex">$t_0$</span> to a terminal state.</li>
<li>The suffix automaton contains the minimum number of vertices among all automata satisfying the conditions described above.</li>
</ul>
<h3 id="substring-property">Substring property<a class="headerlink" href="#substring-property" title="Permanent link">&para;</a></h3>
<p>The simplest and most important property of a suffix automaton is, that it contains information about all substrings of the string <span class="arithmatex">$s$</span>.
Any path starting at the initial state <span class="arithmatex">$t_0$</span>, if we write down the labels of the transitions, forms a <strong>substring</strong> of <span class="arithmatex">$s$</span>.
And conversely every substring of <span class="arithmatex">$s$</span> corresponds to a certain path starting at <span class="arithmatex">$t_0$</span>.</p>
<p>In order to simplify the explanations, we will say that the substring <strong>corresponds</strong> to that path (starting at <span class="arithmatex">$t_0$</span> and the labels spell the substring).
And conversely we say that any path <strong>corresponds</strong> to the string spelled by its labels.</p>
<p>One or multiple paths can lead to a state.
Thus, we will say that a state <strong>corresponds</strong> to the set of strings, which correspond to these paths.</p>
<h3 id="examples-of-constructed-suffix-automata">Examples of constructed suffix automata<a class="headerlink" href="#examples-of-constructed-suffix-automata" title="Permanent link">&para;</a></h3>
<p>Here we will show some examples of suffix automata for several simple strings.</p>
<p>We will denote the initial state with blue and the terminal states with green.</p>
<p>For the string <span class="arithmatex">$s =~ \text{""}$</span>:</p>
<p><img alt="Suffix automaton for &quot;&quot;" src="SA.png" /></p>
<p>For the string <span class="arithmatex">$s =~ \text{"a"}$</span>:</p>
<p><img alt="Suffix automaton for &quot;a&quot;" src="SAa.png" /></p>
<p>For the string <span class="arithmatex">$s =~ \text{"aa"}$</span>:</p>
<p><img alt="Suffix automaton for &quot;aa&quot;" src="SAaa.png" /></p>
<p>For the string <span class="arithmatex">$s =~ \text{"ab"}$</span>:</p>
<p><img alt="Suffix automaton for &quot;ab&quot;" src="SAab.png" /></p>
<p>For the string <span class="arithmatex">$s =~ \text{"aba"}$</span>:</p>
<p><img alt="Suffix automaton for &quot;aba&quot;" src="SAaba.png" /></p>
<p>For the string <span class="arithmatex">$s =~ \text{"abb"}$</span>:</p>
<p><img alt="Suffix automaton for &quot;abb&quot;" src="SAabb.png" /></p>
<p>For the string <span class="arithmatex">$s =~ \text{"abbb"}$</span>:</p>
<p><img alt="Suffix automaton for &quot;abbb&quot;" src="SAabbb.png" /></p>
<h2 id="construction-in-linear-time">Construction in linear time<a class="headerlink" href="#construction-in-linear-time" title="Permanent link">&para;</a></h2>
<p>Before we describe the algorithm to construct a suffix automaton in linear time, we need to introduce several new concepts and simple proofs, which will be very important in understanding the construction.</p>
<h3 id="end-positions-endpos">End positions <span class="arithmatex">$endpos$</span><a class="headerlink" href="#end-positions-endpos" title="Permanent link">&para;</a></h3>
<p>Consider any non-empty substring <span class="arithmatex">$t$</span> of the string <span class="arithmatex">$s$</span>.
We will denote with <span class="arithmatex">$endpos(t)$</span> the set of all positions in the string <span class="arithmatex">$s$</span>, in which the occurrences of <span class="arithmatex">$t$</span> end. For instance, we have <span class="arithmatex">$endpos(\text{"bc"}) = \{2, 4\}$</span> for the string <span class="arithmatex">$\text{"abcbc"}$</span>.</p>
<p>We will call two substrings <span class="arithmatex">$t_1$</span> and <span class="arithmatex">$t_2$</span> <span class="arithmatex">$endpos$</span>-equivalent, if their ending sets coincide: <span class="arithmatex">$endpos(t_1) = endpos(t_2)$</span>.
Thus all non-empty substrings of the string <span class="arithmatex">$s$</span> can be decomposed into several <strong>equivalence classes</strong> according to their sets <span class="arithmatex">$endpos$</span>.</p>
<p>It turns out, that in a suffix machine <span class="arithmatex">$endpos$</span>-equivalent substrings <strong>correspond to the same state</strong>.
In other words the number of states in a suffix automaton is equal to the number of equivalence classes among all substrings, plus the initial state.
Each state of a suffix automaton corresponds to one or more substrings having the same value <span class="arithmatex">$endpos$</span>.</p>
<p>We will later describe the construction algorithm using this assumption.
We will then see, that all the required properties of a suffix automaton, except for the minimality, are fulfilled.
And the minimality follows from Nerode's theorem (which will not be proven in this article).</p>
<p>We can make some important observations concerning the values <span class="arithmatex">$endpos$</span>:</p>
<p><strong>Lemma 1</strong>:
Two non-empty substrings <span class="arithmatex">$u$</span> and <span class="arithmatex">$w$</span> (with <span class="arithmatex">$length(u) \le length(w)$</span>) are <span class="arithmatex">$endpos$</span>-equivalent, if and only if the string <span class="arithmatex">$u$</span> occurs in <span class="arithmatex">$s$</span> only in the form of a suffix of <span class="arithmatex">$w$</span>.</p>
<p>The proof is obvious.
If <span class="arithmatex">$u$</span> and <span class="arithmatex">$w$</span> have the same <span class="arithmatex">$endpos$</span> values, then <span class="arithmatex">$u$</span> is a suffix of <span class="arithmatex">$w$</span> and appears only in the form of a suffix of <span class="arithmatex">$w$</span> in <span class="arithmatex">$s$</span>.
And if <span class="arithmatex">$u$</span> is a suffix of <span class="arithmatex">$w$</span> and appears only in the form as a suffix in <span class="arithmatex">$s$</span>, then the values <span class="arithmatex">$endpos$</span> are equal by definition.</p>
<p><strong>Lemma 2</strong>:
Consider two non-empty substrings <span class="arithmatex">$u$</span> and <span class="arithmatex">$w$</span> (with <span class="arithmatex">$length(u) \le length(w)$</span>).
Then their sets <span class="arithmatex">$endpos$</span> either don't intersect at all, or <span class="arithmatex">$endpos(w)$</span> is a subset of <span class="arithmatex">$endpos(u)$</span>.
And it depends on if <span class="arithmatex">$u$</span> is a suffix of <span class="arithmatex">$w$</span> or not.</p>
<div class="arithmatex">$$\begin{cases}
endpos(w) \subseteq endpos(u) &amp; \text{if } u \text{ is a suffix of } w \\\\
endpos(w) \cap endpos(u) = \emptyset &amp; \text{otherwise}
\end{cases}$$</div>
<p>Proof:
If the sets <span class="arithmatex">$endpos(u)$</span> and <span class="arithmatex">$endpos(w)$</span> have at least one common element, then the strings <span class="arithmatex">$u$</span> and <span class="arithmatex">$w$</span> both end in that position, i.e. <span class="arithmatex">$u$</span> is a suffix of <span class="arithmatex">$w$</span>.
But then at every occurrence of <span class="arithmatex">$w$</span> also appears the substring <span class="arithmatex">$u$</span>, which means that <span class="arithmatex">$endpos(w)$</span> is a subset of <span class="arithmatex">$endpos(u)$</span>.</p>
<p><strong>Lemma 3</strong>:
Consider an <span class="arithmatex">$endpos$</span>-equivalence class.
Sort all the substrings in this class by decreasing length.
Then in the resulting sequence each substring will be one shorter than the previous one, and at the same time will be a suffix of the previous one.
In other words, in a same equivalence class, the shorter substrings are actually suffixes of the longer substrings, and they take all possible lengths in a certain interval <span class="arithmatex">$[x; y]$</span>.</p>
<p>Proof:
Fix some <span class="arithmatex">$endpos$</span>-equivalence class.
If it only contains one string, then the lemma is obviously true.
Now let's say that the number of strings in the class is greater than one.</p>
<p>According to Lemma 1, two different <span class="arithmatex">$endpos$</span>-equivalent strings are always in such a way, that the shorter one is a proper suffix of the longer one.
Consequently, there cannot be two strings of the same length in the equivalence class.</p>
<p>Let's denote by <span class="arithmatex">$w$</span> the longest, and through <span class="arithmatex">$u$</span> the shortest string in the equivalence class.
According to Lemma 1, the string <span class="arithmatex">$u$</span> is a proper suffix of the string <span class="arithmatex">$w$</span>.
Consider now any suffix of <span class="arithmatex">$w$</span> with a length in the interval <span class="arithmatex">$[length(u); length(w)]$</span>.
It is easy to see, that this suffix is also contained in the same equivalence class.
Because this suffix can only appear in the form of a suffix of <span class="arithmatex">$w$</span> in the string <span class="arithmatex">$s$</span> (since also the shorter suffix <span class="arithmatex">$u$</span> occurs in <span class="arithmatex">$s$</span> only in the form of a suffix of <span class="arithmatex">$w$</span>).
Consequently, according to Lemma 1, this suffix is <span class="arithmatex">$endpos$</span>-equivalent to the string <span class="arithmatex">$w$</span>.</p>
<h3 id="suffix-links-link">Suffix links <span class="arithmatex">$link$</span><a class="headerlink" href="#suffix-links-link" title="Permanent link">&para;</a></h3>
<p>Consider some state <span class="arithmatex">$v \ne t_0$</span> in the automaton.
As we know, the state <span class="arithmatex">$v$</span> corresponds to the class of strings with the same <span class="arithmatex">$endpos$</span> values.
And if we denote by <span class="arithmatex">$w$</span> the longest of these strings, then all the other strings are suffixes of <span class="arithmatex">$w$</span>.</p>
<p>We also know the first few suffixes of a string <span class="arithmatex">$w$</span> (if we consider suffixes in descending order of their length) are all contained in this equivalence class, and all other suffixes (at least one other - the empty suffix) are in some other classes.
We denote by <span class="arithmatex">$t$</span> the biggest such suffix, and make a suffix link to it.</p>
<p>In other words, a <strong>suffix link</strong> <span class="arithmatex">$link(v)$</span> leads to the state that corresponds to the <strong>longest suffix</strong> of <span class="arithmatex">$w$</span> that is in another <span class="arithmatex">$endpos$</span>-equivalence class.</p>
<p>Here we assume that the initial state <span class="arithmatex">$t_0$</span> corresponds to its own equivalence class (containing only the empty string), and for convenience we set <span class="arithmatex">$endpos(t_0) = \{-1, 0, \dots, length(s)-1\}$</span>.</p>
<p><strong>Lemma 4</strong>:
Suffix links form a <strong>tree</strong> with the root <span class="arithmatex">$t_0$</span>.</p>
<p>Proof:
Consider an arbitrary state <span class="arithmatex">$v \ne t_0$</span>.
A suffix link <span class="arithmatex">$link(v)$</span> leads to a state corresponding to strings with strictly smaller length (this follows from the definition of the suffix links and from Lemma 3).
Therefore, by moving along the suffix links, we will sooner or later come to the initial state <span class="arithmatex">$t_0$</span>, which corresponds to the empty string.</p>
<p><strong>Lemma 5</strong>:
If we construct a tree using the sets <span class="arithmatex">$endpos$</span> (by the rule that the set of a parent node contains the sets of all children as subsets), then the structure will coincide with the tree of suffix links.</p>
<p>Proof:
The fact that we can construct a tree using the sets <span class="arithmatex">$endpos$</span> follows directly from Lemma 2 (that any two sets either do not intersect or one is contained in the other).</p>
<p>Let us now consider an arbitrary state <span class="arithmatex">$v \ne t_0$</span>, and its suffix link <span class="arithmatex">$link(v)$</span>.
From the definition of the suffix link and from Lemma 2 it follows that</p>
<div class="arithmatex">$$endpos(v) \subseteq endpos(link(v)),$$</div>
<p>which together with the previous lemma proves the assertion:
the tree of suffix links is essentially a tree of sets <span class="arithmatex">$endpos$</span>.</p>
<p>Here is an <strong>example</strong> of a tree of suffix links in the suffix automaton build for the string <span class="arithmatex">$\text{"abcbc"}$</span>.
The nodes are labeled with the longest substring from the corresponding equivalence class.</p>
<p><img alt="Suffix automaton for &quot;abcbc&quot; with suffix links" src="SA_suffix_links.png" /></p>
<h3 id="recap">Recap<a class="headerlink" href="#recap" title="Permanent link">&para;</a></h3>
<p>Before proceeding to the algorithm itself, we recap the accumulated knowledge, and introduce a few auxiliary notations.</p>
<ul>
<li>The substrings of the string <span class="arithmatex">$s$</span> can be decomposed into equivalence classes according to their end positions <span class="arithmatex">$endpos$</span>.</li>
<li>The suffix automaton consists of the initial state <span class="arithmatex">$t_0$</span>, as well as of one state for each <span class="arithmatex">$endpos$</span>-equivalence class.</li>
<li>For each state <span class="arithmatex">$v$</span> one or multiple substrings match.
  We denote by <span class="arithmatex">$longest(v)$</span> the longest such string, and through <span class="arithmatex">$len(v)$</span> its length.
  We denote by <span class="arithmatex">$shortest(v)$</span> the shortest such substring, and its length with <span class="arithmatex">$minlen(v)$</span>.
  Then all the strings corresponding to this state are different suffixes of the string <span class="arithmatex">$longest(v)$</span> and have all possible lengths in the interval <span class="arithmatex">$[minlen(v); len(v)]$</span>.</li>
<li>For each state <span class="arithmatex">$v \ne t_0$</span> a suffix link is defined as a link, that leads to a state that corresponds to the suffix of the string <span class="arithmatex">$longest(v)$</span> of length <span class="arithmatex">$minlen(v) - 1$</span>.
  The suffix links form a tree with the root in <span class="arithmatex">$t_0$</span>, and at the same time this tree forms an inclusion relationship between the sets <span class="arithmatex">$endpos$</span>.</li>
<li>We can express <span class="arithmatex">$minlen(v)$</span> for <span class="arithmatex">$v \ne t_0$</span> using the suffix link <span class="arithmatex">$link(v)$</span> as:</li>
</ul>
<div class="arithmatex">$$minlen(v) = len(link(v)) + 1$$</div>
<ul>
<li>If we start from an arbitrary state <span class="arithmatex">$v_0$</span> and follow the suffix links, then sooner or later we will reach the initial state <span class="arithmatex">$t_0$</span>.
  In this case we obtain a sequence of disjoint intervals <span class="arithmatex">$[minlen(v_i); len(v_i)]$</span>, which in union forms the continuous interval <span class="arithmatex">$[0; len(v_0)]$</span>.</li>
</ul>
<h3 id="algorithm">Algorithm<a class="headerlink" href="#algorithm" title="Permanent link">&para;</a></h3>
<p>Now we can proceed to the algorithm itself.
The algorithm will be <strong>online</strong>, i.e. we will add the characters of the string one by one, and modify the automaton accordingly in each step.</p>
<p>To achieve linear memory consumption, we will only store the values <span class="arithmatex">$len$</span>, <span class="arithmatex">$link$</span> and a list of transitions in each state.
We will not label terminal states (but we will later show how to arrange these labels after constructing the suffix automaton).</p>
<p>Initially the automaton consists of a single state <span class="arithmatex">$t_0$</span>, which will be the index <span class="arithmatex">$0$</span> (the remaining states will receive the indices <span class="arithmatex">$1, 2, \dots$</span>).
We assign it <span class="arithmatex">$len = 0$</span> and <span class="arithmatex">$link = -1$</span> for convenience (<span class="arithmatex">$-1$</span> will be a fictional, non-existing state).</p>
<p>Now the whole task boils down to implementing the process of <strong>adding one character</strong> <span class="arithmatex">$c$</span> to the end of the current string.
Let us describe this process:</p>
<ul>
<li>Let <span class="arithmatex">$last$</span> be the state corresponding to the entire string before adding the character <span class="arithmatex">$c$</span>.
    (Initially we set <span class="arithmatex">$last = 0$</span>, and we will change <span class="arithmatex">$last$</span> in the last step of the algorithm accordingly.)</li>
<li>Create a new state <span class="arithmatex">$cur$</span>, and assign it with <span class="arithmatex">$len(cur) = len(last) + 1$</span>.
    The value <span class="arithmatex">$link(cur)$</span> is not known at the time.</li>
<li>Now we do the following procedure:
    We start at the state <span class="arithmatex">$last$</span>.
    While there isn't a transition through the letter <span class="arithmatex">$c$</span>, we will add a transition to the state <span class="arithmatex">$cur$</span>, and follow the suffix link.
    If at some point there already exists a transition through the letter <span class="arithmatex">$c$</span>, then we will stop and denote this state with <span class="arithmatex">$p$</span>.</li>
<li>If we haven't found such a state <span class="arithmatex">$p$</span>, then we reached the fictitious state <span class="arithmatex">$-1$</span>, then we can just assign <span class="arithmatex">$link(cur) = 0$</span> and leave.</li>
<li>Suppose now that we have found a state <span class="arithmatex">$p$</span>, from which there exists a transition through the letter <span class="arithmatex">$c$</span>.
    We will denote the state, to which the transition leads,  with <span class="arithmatex">$q$</span>.</li>
<li>Now we have two cases. Either <span class="arithmatex">$len(p) + 1 = len(q)$</span>, or not.</li>
<li>If <span class="arithmatex">$len(p) + 1 = len(q)$</span>, then we can simply assign <span class="arithmatex">$link(cur) = q$</span> and leave.</li>
<li>
<p>Otherwise it is a bit more complicated.
    It is necessary to <strong>clone</strong> the state <span class="arithmatex">$q$</span>:
    we create a new state <span class="arithmatex">$clone$</span>, copy all the data from <span class="arithmatex">$q$</span> (suffix link and transition) except the value <span class="arithmatex">$len$</span>.
    We will assign <span class="arithmatex">$len(clone) = len(p) + 1$</span>.</p>
<p>After cloning we direct the suffix link from <span class="arithmatex">$cur$</span> to <span class="arithmatex">$clone$</span>, and also from <span class="arithmatex">$q$</span> to clone.</p>
<p>Finally we need to walk from the state <span class="arithmatex">$p$</span> back using suffix links as long as there is a transition through <span class="arithmatex">$c$</span> to the state <span class="arithmatex">$q$</span>, and redirect all those to the state <span class="arithmatex">$clone$</span>.</p>
</li>
<li>
<p>In any of the three cases, after completing the procedure, we update the value <span class="arithmatex">$last$</span> with the state <span class="arithmatex">$cur$</span>.</p>
</li>
</ul>
<p>If we also want to know which states are <strong>terminal</strong> and which are not, we can find all terminal states after constructing the complete suffix automaton for the entire string <span class="arithmatex">$s$</span>.
To do this, we take the state corresponding to the entire string (stored in the variable <span class="arithmatex">$last$</span>), and follow its suffix links until we reach the initial state.
We will mark all visited states as terminal.
It is easy to understand that by doing so we will mark exactly the states corresponding to all the suffixes of the string <span class="arithmatex">$s$</span>, which are exactly the terminal states.</p>
<p>In the next section we will look in detail at each step and show its <strong>correctness</strong>.</p>
<p>Here we only note that, since we only create one or two new states for each character of <span class="arithmatex">$s$</span>, the suffix automaton contains a <strong>linear number of states</strong>.</p>
<p>The linearity of the number of transitions, and in general the linearity of the runtime of the algorithm is less clear, and they will be proven after we proved the correctness.</p>
<h3 id="correctness">Correctness<a class="headerlink" href="#correctness" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>We will call a transition <span class="arithmatex">$(p, q)$</span> <strong>continuous</strong> if <span class="arithmatex">$len(p) + 1 = len(q)$</span>.
    Otherwise, i.e. when <span class="arithmatex">$len(p) + 1 &lt; len(q)$</span>, the transition will be called <strong>non-continuous</strong>.</p>
<p>As we can see from the description of the algorithm, continuous and non-continuous transitions will lead to different cases of the algorithm.
Continuous transitions are fixed, and will never change again.
In contrast non-continuous transition may change, when new letters are added to the string (the end of the transition edge may change).</p>
</li>
<li>
<p>To avoid ambiguity we will denote the string, for which the suffix automaton was built before adding the current character <span class="arithmatex">$c$</span>, with <span class="arithmatex">$s$</span>.</p>
</li>
<li>
<p>The algorithm begins with creating a new state <span class="arithmatex">$cur$</span>, which will correspond to the entire string <span class="arithmatex">$s + c$</span>.
    It is clear why we have to create a new state.
    Together with the new character a new equivalence class is created.</p>
</li>
<li>
<p>After creating a new state we traverse by suffix links starting from the state corresponding to the entire string <span class="arithmatex">$s$</span>.
    For each state we try to add a transition with the character <span class="arithmatex">$c$</span> to the new state <span class="arithmatex">$cur$</span>.
    Thus we append to each suffix of <span class="arithmatex">$s$</span> the character <span class="arithmatex">$c$</span>.
    However we can only add these new transitions, if they don't conflict with an already existing one.
    Therefore as soon as we find an already existing transition with <span class="arithmatex">$c$</span> we have to stop.</p>
</li>
<li>
<p>In the simplest case we reached the fictitious state <span class="arithmatex">$-1$</span>.
    This means we added the transition with <span class="arithmatex">$c$</span> to all suffixes of <span class="arithmatex">$s$</span>.
    This also means, that the character <span class="arithmatex">$c$</span> hasn't been part of the string <span class="arithmatex">$s$</span> before.
    Therefore the suffix link of <span class="arithmatex">$cur$</span> has to lead to the state <span class="arithmatex">$0$</span>.</p>
</li>
<li>
<p>In the second case we came across an existing transition <span class="arithmatex">$(p, q)$</span>.
    This means that we tried to add a string <span class="arithmatex">$x + c$</span> (where <span class="arithmatex">$x$</span> is a suffix of <span class="arithmatex">$s$</span>) to the machine that <strong>already exists</strong> in the machine (the string <span class="arithmatex">$x + c$</span> already appears as a substring of <span class="arithmatex">$s$</span>).
    Since we assume that the automaton for the string <span class="arithmatex">$s$</span> is built correctly, we should not add a new transition here.</p>
<p>However there is a difficulty.
To which state should the suffix link from the state <span class="arithmatex">$cur$</span> lead?
We have to make a suffix link to a state, in which the longest string is exactly <span class="arithmatex">$x + c$</span>, i.e. the <span class="arithmatex">$len$</span> of this state should be <span class="arithmatex">$len(p) + 1$</span>.
However it is possible, that such a state doesn't yet exists, i.e. <span class="arithmatex">$len(q) &gt; len(p) + 1$</span>.
In this case we have to create such a state, by <strong>splitting</strong> the state <span class="arithmatex">$q$</span>.</p>
</li>
<li>
<p>If the transition <span class="arithmatex">$(p, q)$</span> turns out to be continuous, then <span class="arithmatex">$len(q) = len(p) + 1$</span>.
    In this case everything is simple.
    We direct the suffix link from <span class="arithmatex">$cur$</span> to the state <span class="arithmatex">$q$</span>.</p>
</li>
<li>
<p>Otherwise the transition is non-continuous, i.e. <span class="arithmatex">$len(q) &gt; len(p) + 1$</span>.
    This means that the state <span class="arithmatex">$q$</span> corresponds to not only the suffix of <span class="arithmatex">$s + c$</span> with length <span class="arithmatex">$len(p) + 1$</span>, but also to longer substrings of <span class="arithmatex">$s$</span>.
    We can do nothing other than <strong>splitting</strong> the state <span class="arithmatex">$q$</span> into two sub-states, so that the first one has length <span class="arithmatex">$len(p) + 1$</span>.</p>
<p>How can we split a state?
We <strong>clone</strong> the state <span class="arithmatex">$q$</span>, which gives us the state <span class="arithmatex">$clone$</span>, and we set <span class="arithmatex">$len(clone) = len(p) + 1$</span>.
We copy all the transitions from <span class="arithmatex">$q$</span> to <span class="arithmatex">$clone$</span>, because we don't want to change the paths that traverse through <span class="arithmatex">$q$</span>.
Also we set the suffix link from <span class="arithmatex">$clone$</span> to the target of the suffix link of <span class="arithmatex">$q$</span>, and set the suffix link of <span class="arithmatex">$q$</span> to <span class="arithmatex">$clone$</span>.</p>
<p>And after splitting the state, we set the suffix link from <span class="arithmatex">$cur$</span> to <span class="arithmatex">$clone$</span>.</p>
<p>In the last step we change some of the transitions to <span class="arithmatex">$q$</span>, we redirect them to <span class="arithmatex">$clone$</span>.
Which transitions do we have to change?
It is enough to redirect only the transitions corresponding to all the suffixes of the string <span class="arithmatex">$w + c$</span> (where <span class="arithmatex">$w$</span> is the longest string of <span class="arithmatex">$p$</span>), i.e. we need to continue to move along the suffix links, starting from the vertex <span class="arithmatex">$p$</span> until we reach the fictitious state <span class="arithmatex">$-1$</span> or a transition that leads to a different state than <span class="arithmatex">$q$</span>.</p>
</li>
</ul>
<h3 id="linear-number-of-operations">Linear number of operations<a class="headerlink" href="#linear-number-of-operations" title="Permanent link">&para;</a></h3>
<p>First we immediately make the assumption that the size of the alphabet is <strong>constant</strong>.
If this is not the case, then it will not be possible to talk about the linear time complexity.
The list of transitions from one vertex will be stored in a balanced tree, which allows you to quickly perform key search operations and adding keys.
Therefore if we denote with <span class="arithmatex">$k$</span> the size of the alphabet, then the asymptotic behavior of the algorithm will be <span class="arithmatex">$O(n \log k)$</span> with <span class="arithmatex">$O(n)$</span> memory.
However if the alphabet is small enough, then you can sacrifice memory by avoiding balanced trees, and store the transitions at each vertex as an array of length <span class="arithmatex">$k$</span> (for quick searching by key) and a dynamic list (to quickly traverse all available keys).
Thus we reach the <span class="arithmatex">$O(n)$</span> time complexity for the algorithm, but at a cost of <span class="arithmatex">$O(n k)$</span> memory complexity.</p>
<p>So we will consider the size of the alphabet to be constant, i.e. each operation of searching for a transition on a character, adding a transition, searching for the next transition - all these operations can be done in <span class="arithmatex">$O(1)$</span>.</p>
<p>If we consider all parts of the algorithm, then it contains three places in the algorithm in which the linear complexity is not obvious:</p>
<ul>
<li>The first place is the traversal through the suffix links from the state <span class="arithmatex">$last$</span>, adding transitions with the character <span class="arithmatex">$c$</span>.</li>
<li>The second place is the copying of transitions when the state <span class="arithmatex">$q$</span> is cloned into a new state <span class="arithmatex">$clone$</span>.</li>
<li>Third place is changing the transition leading to <span class="arithmatex">$q$</span>, redirecting them to <span class="arithmatex">$clone$</span>.</li>
</ul>
<p>We use the fact that the size of the suffix automaton (both in the number of states and in the number of transitions) is <strong>linear</strong>.
(The proof of the linearity of the number of states is the algorithm itself, and the proof of linearity of the number of states is given below, after the implementation of the algorithm).</p>
<p>Thus the total complexity of the <strong>first and second places</strong> is obvious, after all each operation adds only one amortized new transition to the automaton.</p>
<p>It remains to estimate the total complexity of the <strong>third place</strong>, in which we redirect transitions, that pointed originally to <span class="arithmatex">$q$</span>, to <span class="arithmatex">$clone$</span>.
We denote <span class="arithmatex">$v = longest(p)$</span>.
This is a suffix of the string <span class="arithmatex">$s$</span>, and with each iteration its length decreases - and therefore the position <span class="arithmatex">$v$</span> as the suffix of the string <span class="arithmatex">$s$</span> increases monotonically with each iteration.
In this case, if before the first iteration of the loop, the corresponding string <span class="arithmatex">$v$</span> was at the depth <span class="arithmatex">$k$</span> (<span class="arithmatex">$k \ge 2$</span>) from <span class="arithmatex">$last$</span> (by counting the depth as the number of suffix links), then after the last iteration the string <span class="arithmatex">$v + c$</span> will be a <span class="arithmatex">$2$</span>-th suffix link on the path from <span class="arithmatex">$cur$</span> (which will become the new value <span class="arithmatex">$last$</span>).</p>
<p>Thus, each iteration of this loop leads to the fact that the position of the string <span class="arithmatex">$longest(link(link(last))$</span> as a suffix of the current string will monotonically increase.
Therefore this cycle cannot be executed more than <span class="arithmatex">$n$</span> iterations, which was required to prove.</p>
<h3 id="implementation">Implementation<a class="headerlink" href="#implementation" title="Permanent link">&para;</a></h3>
<p>First we describe a data structure that will store all information about a specific transition (<span class="arithmatex">$len$</span>, <span class="arithmatex">$link$</span> and the list of transitions).
If necessary you can add a terminal flag here, as well as other information.
We will store the list of transitions in the form of a <span class="arithmatex">$map$</span>, which allows us to achieve total <span class="arithmatex">$O(n)$</span> memory and <span class="arithmatex">$O(n \log k)$</span> time for processing the entire string.</p>
<div class="highlight"><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">state</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">link</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">next</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>The suffix automaton itself will be stored in an array of these structures <span class="arithmatex">$state$</span>.
We store the current size <span class="arithmatex">$sz$</span> and also the variable <span class="arithmatex">$last$</span>, the state corresponding to the entire string at the moment.</p>
<div class="highlight"><pre><span></span><code><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">MAXLEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100000</span><span class="p">;</span>
<span class="n">state</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">MAXLEN</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">sz</span><span class="p">,</span><span class="w"> </span><span class="n">last</span><span class="p">;</span>
</code></pre></div>
<p>We give a function that initializes a suffix automaton (creating a suffix automaton with a single state).</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">sa_init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="n">sz</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="n">last</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>And finally we give the implementation of the main function - which adds the next character to the end of the current line, rebuilding the machine accordingly.</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">sa_extend</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sz</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="n">st</span><span class="p">[</span><span class="n">cur</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">last</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">last</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">next</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">next</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cur</span><span class="p">;</span>
<span class="w">        </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">link</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">st</span><span class="p">[</span><span class="n">cur</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">next</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">q</span><span class="p">].</span><span class="n">len</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">st</span><span class="p">[</span><span class="n">cur</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sz</span><span class="o">++</span><span class="p">;</span>
<span class="w">            </span><span class="n">st</span><span class="p">[</span><span class="n">clone</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="n">st</span><span class="p">[</span><span class="n">clone</span><span class="p">].</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">q</span><span class="p">].</span><span class="n">next</span><span class="p">;</span>
<span class="w">            </span><span class="n">st</span><span class="p">[</span><span class="n">clone</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">q</span><span class="p">].</span><span class="n">link</span><span class="p">;</span>
<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">next</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">next</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clone</span><span class="p">;</span>
<span class="w">                </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">link</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">st</span><span class="p">[</span><span class="n">q</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">cur</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clone</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">last</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cur</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>As mentioned above, if you sacrifice memory (<span class="arithmatex">$O(n k)$</span>, where <span class="arithmatex">$k$</span> is the size of the alphabet), then you can achieve the build time of the machine in <span class="arithmatex">$O(n)$</span>, even for any alphabet size <span class="arithmatex">$k$</span>.
But for this you will have to store an array of size <span class="arithmatex">$k$</span> in each state (for quickly jumping to the transition of the letter), and additional a list of all transitions (to quickly iterate over the transitions them).</p>
<h2 id="additional-properties">Additional properties<a class="headerlink" href="#additional-properties" title="Permanent link">&para;</a></h2>
<h3 id="number-of-states">Number of states<a class="headerlink" href="#number-of-states" title="Permanent link">&para;</a></h3>
<p>The number of states in a suffix automaton of the string <span class="arithmatex">$s$</span> of length <span class="arithmatex">$n$</span> <strong>doesn't exceed</strong> <span class="arithmatex">$2n - 1$</span> (for <span class="arithmatex">$n \ge 2$</span>).</p>
<p>The proof is the construction algorithm itself, since initially the automaton consists of one state, and in the first and second iteration only a single state will be created, and in the remaining <span class="arithmatex">$n-2$</span> steps at most <span class="arithmatex">$2$</span> states will be created each.</p>
<p>However we can also <strong>show</strong> this estimation <strong>without knowing the algorithm</strong>.
Let us recall that the number of states is equal to the number of different sets <span class="arithmatex">$endpos$</span>.
In addition theses sets <span class="arithmatex">$endpos$</span> form a tree (a parent vertex contains all children sets in his set).
Consider this tree and transform it a little bit:
as long as it has an internal vertex with only one child (which means that the set of the child misses at least one position from the parent set), we create a new child with the set of the missing positions.
In the end we have a tree in which each inner vertex has a degree greater than one, and the number of leaves does not exceed <span class="arithmatex">$n$</span>.
Therefore there are no more than <span class="arithmatex">$2n - 1$</span> vertices in such a tree.</p>
<p>This bound of the number of states can actually be achieved for each <span class="arithmatex">$n$</span>.
A possible string is:</p>
<div class="arithmatex">$$\text{"abbb}\dots \text{bbb"}$$</div>
<p>In each iteration, starting at the third one, the algorithm will split a state, resulting in exactly <span class="arithmatex">$2n - 1$</span> states.</p>
<h3 id="number-of-transitions">Number of transitions<a class="headerlink" href="#number-of-transitions" title="Permanent link">&para;</a></h3>
<p>The number of transitions in a suffix automaton of a string <span class="arithmatex">$s$</span> of length <span class="arithmatex">$n$</span> <strong>doesn't exceed</strong> <span class="arithmatex">$3n - 4$</span> (for <span class="arithmatex">$n \ge 3$</span>).</p>
<p>Let us prove this:</p>
<p>Let us first estimate the number of continuous transitions.
Consider a spanning tree of the longest paths in the automaton starting in the state <span class="arithmatex">$t_0$</span>.
This skeleton will consist of only the continuous edges, and therefore their number is less than the number of states, i.e. it does not exceed <span class="arithmatex">$2n - 2$</span>.</p>
<p>Now let us estimate the number of non-continuous transitions.
Let the current non-continuous transition be <span class="arithmatex">$(p, q)$</span> with the character <span class="arithmatex">$c$</span>.
We take the correspondent string <span class="arithmatex">$u + c + w$</span>, where the string <span class="arithmatex">$u$</span> corresponds to the longest path from the initial state to <span class="arithmatex">$p$</span>, and <span class="arithmatex">$w$</span> to the longest path from <span class="arithmatex">$q$</span> to any terminal state.
On one hand, each such string <span class="arithmatex">$u + c + w$</span> for each incomplete strings will be different (since the strings <span class="arithmatex">$u$</span> and <span class="arithmatex">$w$</span> are formed only by complete transitions).
On the other hand each such string <span class="arithmatex">$u + c + w$</span>, by the definition of the terminal states, will be a suffix of the entire string <span class="arithmatex">$s$</span>.
Since there are only <span class="arithmatex">$n$</span> non-empty suffixes of <span class="arithmatex">$s$</span>, and none of the strings <span class="arithmatex">$u + c + w$</span> can contain <span class="arithmatex">$s$</span> (because the entire string only contains complete transitions), the total number of incomplete transitions does not exceed <span class="arithmatex">$n - 1$</span>.</p>
<p>Combining these two estimates gives us the bound <span class="arithmatex">$3n - 3$</span>.
However, since the maximum number of states can only be achieved with the test case <span class="arithmatex">$\text{"abbb\dots bbb"}$</span> and this case has clearly less than <span class="arithmatex">$3n - 3$</span> transitions, we get the tighter bound of <span class="arithmatex">$3n - 4$</span> for the number of transitions in a suffix automaton.</p>
<p>This bound can also be achieved with the string:</p>
<div class="arithmatex">$$\text{"abbb}\dots \text{bbbc"}$$</div>
<h2 id="applications">Applications<a class="headerlink" href="#applications" title="Permanent link">&para;</a></h2>
<p>Here we look at some tasks that can be solved using the suffix automaton.
For the simplicity we assume that the alphabet size <span class="arithmatex">$k$</span> is constant, which allows us to consider the complexity of appending a character and the traversal as constant.</p>
<h3 id="check-for-occurrence">Check for occurrence<a class="headerlink" href="#check-for-occurrence" title="Permanent link">&para;</a></h3>
<p>Given a text <span class="arithmatex">$T$</span>, and multiple patterns <span class="arithmatex">$P$</span>.
We have to check whether or not the strings <span class="arithmatex">$P$</span> appear as a substring of <span class="arithmatex">$T$</span>.</p>
<p>We build a suffix automaton of the text <span class="arithmatex">$T$</span> in <span class="arithmatex">$O(length(T))$</span> time.
To check if a pattern <span class="arithmatex">$P$</span> appears in <span class="arithmatex">$T$</span>, we follow the transitions, starting from <span class="arithmatex">$t_0$</span>, according to the characters of <span class="arithmatex">$P$</span>.
If at some point there doesn't exists a transition, then the pattern <span class="arithmatex">$P$</span> doesn't appear as a substring of <span class="arithmatex">$T$</span>.
If we can process the entire string <span class="arithmatex">$P$</span> this way, then the string appears in <span class="arithmatex">$T$</span>.</p>
<p>It is clear that this will take <span class="arithmatex">$O(length(P))$</span> time for each string <span class="arithmatex">$P$</span>.
Moreover the algorithm actually finds the length of the longest prefix of <span class="arithmatex">$P$</span> that appears in the text.</p>
<h3 id="number-of-different-substrings">Number of different substrings<a class="headerlink" href="#number-of-different-substrings" title="Permanent link">&para;</a></h3>
<p>Given a string <span class="arithmatex">$S$</span>.
You want to compute the number of different substrings.</p>
<p>Let us build a suffix automaton for the string <span class="arithmatex">$S$</span>.</p>
<p>Each substring of <span class="arithmatex">$S$</span> corresponds to some path in the automaton.
Therefore the number of different substrings is equal to the number of different paths in the automaton starting at <span class="arithmatex">$t_0$</span>.</p>
<p>Given that the suffix automaton is a directed acyclic graph, the number of different ways can be computed using dynamic programming.</p>
<p>Namely, let <span class="arithmatex">$d[v]$</span> be the number of ways, starting at the state <span class="arithmatex">$v$</span> (including the path of length zero).
Then we have the recursion:</p>
<div class="arithmatex">$$d[v] = 1 + \sum_{w : (v, w, c) \in DAWG} d[w]$$</div>
<p>I.e. <span class="arithmatex">$d[v]$</span> can be expressed as the sum of answers for all ends of the transitions of <span class="arithmatex">$v$</span>.</p>
<p>The number of different substrings is the value <span class="arithmatex">$d[t_0] - 1$</span> (since we don't count the empty substring).</p>
<p>Total time complexity: <span class="arithmatex">$O(length(S))$</span></p>
<p>Alternatively, we can take advantage of the fact that each state <span class="arithmatex">$v$</span> matches to substrings of length <span class="arithmatex">$[minlen(v),len(v)]$</span>.
Therefore, given <span class="arithmatex">$minlen(v) = 1 + len(link(v))$</span>, we have total distinct substrings at state <span class="arithmatex">$v$</span> being <span class="arithmatex">$len(v) - minlen(v) + 1 = len(v) - (1 + len(link(v))) + 1 = len(v) - len(link(v))$</span>.</p>
<p>This is demonstrated succinctly below:</p>
<div class="highlight"><pre><span></span><code><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">get_diff_strings</span><span class="p">(){</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sz</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">tot</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">link</span><span class="p">].</span><span class="n">len</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">tot</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>While this is also <span class="arithmatex">$O(length(S))$</span>, it requires no extra space and no recursive calls, consequently running faster in practice.</p>
<h3 id="total-length-of-all-different-substrings">Total length of all different substrings<a class="headerlink" href="#total-length-of-all-different-substrings" title="Permanent link">&para;</a></h3>
<p>Given a string <span class="arithmatex">$S$</span>.
We want to compute the total length of all its various substrings.</p>
<p>The solution is similar to the previous one, only now it is necessary to consider two quantities for the dynamic programming part:
the number of different substrings <span class="arithmatex">$d[v]$</span> and their total length <span class="arithmatex">$ans[v]$</span>.</p>
<p>We already described how to compute <span class="arithmatex">$d[v]$</span> in the previous task.
The value <span class="arithmatex">$ans[v]$</span> can be computed using the recursion:</p>
<div class="arithmatex">$$ans[v] = \sum_{w : (v, w, c) \in DAWG} d[w] + ans[w]$$</div>
<p>We take the answer of each adjacent vertex <span class="arithmatex">$w$</span>, and add to it <span class="arithmatex">$d[w]$</span> (since every substring is one character longer when starting from the state <span class="arithmatex">$v$</span>).</p>
<p>Again this task can be computed in <span class="arithmatex">$O(length(S))$</span> time.</p>
<p>Alternatively, we can, again, take advantage of the fact that each state <span class="arithmatex">$v$</span> matches to substrings of length <span class="arithmatex">$[minlen(v),len(v)]$</span>.
Since <span class="arithmatex">$minlen(v) = 1 + len(link(v))$</span> and the arithmetic series formula <span class="arithmatex">$S_n = n \cdot \frac{a_1+a_n}{2}$</span> (where <span class="arithmatex">$S_n$</span> denotes the sum of <span class="arithmatex">$n$</span> terms, <span class="arithmatex">$a_1$</span> representing the first term, and <span class="arithmatex">$a_n$</span> representing the last), we can compute the length of substrings at a state in constant time.  We then sum up these totals for each state <span class="arithmatex">$v \neq t_0$</span> in the automaton. This is shown by the code below:</p>
<div class="highlight"><pre><span></span><code><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">get_tot_len_diff_substings</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sz</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">shortest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">link</span><span class="p">].</span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">longest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">len</span><span class="p">;</span>

<span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">num_strings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">longest</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">shortest</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_strings</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">longest</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">shortest</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">        </span><span class="n">tot</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">cur</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">tot</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>This approach runs in  <span class="arithmatex">$O(length(S))$</span> time, but experimentally runs 20x faster than the memoized dynamic programming version on randomized strings. It requires no extra space and no recursion.</p>
<h3 id="lexicographically-k-th-substring">Lexicographically <span class="arithmatex">$k$</span>-th substring<a class="headerlink" href="#lexicographically-k-th-substring" title="Permanent link">&para;</a></h3>
<p>Given a string <span class="arithmatex">$S$</span>.
We have to answer multiple queries.
For each given number <span class="arithmatex">$K_i$</span> we have to find the <span class="arithmatex">$K_i$</span>-th string in the lexicographically ordered list of all substrings.</p>
<p>The solution to this problem is based on the idea of the previous two problems.
The lexicographically <span class="arithmatex">$k$</span>-th substring corresponds to the lexicographically <span class="arithmatex">$k$</span>-th path in the suffix automaton.
Therefore after counting the number of paths from each state, we can easily search for the <span class="arithmatex">$k$</span>-th path starting from the root of the automaton.</p>
<p>This takes <span class="arithmatex">$O(length(S))$</span> time for preprocessing and then <span class="arithmatex">$O(length(ans) \cdot k)$</span> for each query (where <span class="arithmatex">$ans$</span> is the answer for the query and <span class="arithmatex">$k$</span> is the size of the alphabet).</p>
<h3 id="smallest-cyclic-shift">Smallest cyclic shift<a class="headerlink" href="#smallest-cyclic-shift" title="Permanent link">&para;</a></h3>
<p>Given a string <span class="arithmatex">$S$</span>.
We want to find the lexicographically smallest cyclic shift.</p>
<p>We construct a suffix automaton for the string <span class="arithmatex">$S + S$</span>.
Then the automaton will contain in itself as paths all the cyclic shifts of the string <span class="arithmatex">$S$</span>.</p>
<p>Consequently the problem is reduced to finding the lexicographically smallest path of length <span class="arithmatex">$length(S)$</span>, which can be done in a trivial way: we start in the initial state and greedily pass through the transitions with the minimal character.</p>
<p>Total time complexity is <span class="arithmatex">$O(length(S))$</span>.</p>
<h3 id="number-of-occurrences">Number of occurrences<a class="headerlink" href="#number-of-occurrences" title="Permanent link">&para;</a></h3>
<p>For a given text <span class="arithmatex">$T$</span>.
We have to answer multiple queries.
For each given pattern <span class="arithmatex">$P$</span> we have to find out how many times the string <span class="arithmatex">$P$</span> appears in the string <span class="arithmatex">$T$</span> as a substring.</p>
<p>We construct the suffix automaton for the text <span class="arithmatex">$T$</span>.</p>
<p>Next we do the following preprocessing:
for each state <span class="arithmatex">$v$</span> in the automaton we calculate the number <span class="arithmatex">$cnt[v]$</span> that is equal to the size of the set <span class="arithmatex">$endpos(v)$</span>.
In fact all strings corresponding to the same state <span class="arithmatex">$v$</span> appear in the text <span class="arithmatex">$T$</span> an equal amount of times, which is equal to the number of positions in the set <span class="arithmatex">$endpos$</span>.</p>
<p>However we cannot construct the sets <span class="arithmatex">$endpos$</span> explicitly, therefore we only consider their sizes <span class="arithmatex">$cnt$</span>.</p>
<p>To compute them we proceed as follows.
For each state, if it was not created by cloning (and if it is not the initial state <span class="arithmatex">$t_0$</span>), we initialize it with <span class="arithmatex">$cnt = 1$</span>.
Then we will go through all states in decreasing order of their length <span class="arithmatex">$len$</span>, and add the current value <span class="arithmatex">$cnt[v]$</span> to the suffix links:</p>
<div class="arithmatex">$$cnt[link(v)] \text{ += } cnt[v]$$</div>
<p>This gives the correct value for each state.</p>
<p>Why is this correct?
The total number of states obtained <em>not</em> via cloning is exactly <span class="arithmatex">$length(T)$</span>, and the first <span class="arithmatex">$i$</span> of them appeared when we added the first <span class="arithmatex">$i$</span> characters.
Consequently for each of these states we count the corresponding position at which it was processed.
Therefore initially we have <span class="arithmatex">$cnt = 1$</span> for each such state, and <span class="arithmatex">$cnt = 0$</span> for all other.</p>
<p>Then we apply the following operation for each <span class="arithmatex">$v$</span>: <span class="arithmatex">$cnt[link(v)] \text{ += } cnt[v]$</span>.
The meaning behind this is, that if a string <span class="arithmatex">$v$</span> appears <span class="arithmatex">$cnt[v]$</span> times, then also all its suffixes appear at the exact same end positions, therefore also <span class="arithmatex">$cnt[v]$</span> times.</p>
<p>Why don't we overcount in this procedure (i.e. don't count some positions twice)?
Because we add the positions of a state to only one other state, so it can not happen that one state directs its positions to another state twice in two different ways.</p>
<p>Thus we can compute the quantities <span class="arithmatex">$cnt$</span> for all states in the automaton in <span class="arithmatex">$O(length(T))$</span> time.</p>
<p>After that answering a query by just looking up the value <span class="arithmatex">$cnt[t]$</span>, where <span class="arithmatex">$t$</span> is the state corresponding to the pattern, if such a state exists.
Otherwise answer with <span class="arithmatex">$0$</span>.
Answering a query takes <span class="arithmatex">$O(length(P))$</span> time.</p>
<h3 id="first-occurrence-position">First occurrence position<a class="headerlink" href="#first-occurrence-position" title="Permanent link">&para;</a></h3>
<p>Given a text <span class="arithmatex">$T$</span> and multiple queries.
For each query string <span class="arithmatex">$P$</span> we want to find the position of the first occurrence of <span class="arithmatex">$P$</span> in the string <span class="arithmatex">$T$</span> (the position of the beginning of <span class="arithmatex">$P$</span>).</p>
<p>We again construct a suffix automaton.
Additionally we precompute the position <span class="arithmatex">$firstpos$</span> for all states in the automaton, i.e. for each state <span class="arithmatex">$v$</span> we want to find the position <span class="arithmatex">$firstpos[v]$</span> of the end of the first occurrence.
In other words, we want to find in advance the minimal element of each set <span class="arithmatex">$endpos$</span> (since obviously cannot maintain all sets <span class="arithmatex">$endpos$</span> explicitly).</p>
<p>To maintain these positions <span class="arithmatex">$firstpos$</span> we extend the function <code>sa_extend()</code>.
When we create a new state <span class="arithmatex">$cur$</span>, we set:</p>
<div class="arithmatex">$$firstpos(cur) = len(cur) - 1$$</div>
<p>And when we clone a vertex <span class="arithmatex">$q$</span> as <span class="arithmatex">$clone$</span>, we set:</p>
<div class="arithmatex">$$firstpos(clone) = firstpos(q)$$</div>
<p>(since the only other option for a value would be <span class="arithmatex">$firstpos(cur)$</span> which is definitely too big)</p>
<p>Thus the answer for a query is simply <span class="arithmatex">$firstpos(t) - length(P) + 1$</span>, where <span class="arithmatex">$t$</span> is the state corresponding to the string <span class="arithmatex">$P$</span>.
Answering a query again takes only <span class="arithmatex">$O(length(P))$</span> time.</p>
<h3 id="all-occurrence-positions">All occurrence positions<a class="headerlink" href="#all-occurrence-positions" title="Permanent link">&para;</a></h3>
<p>This time we have to display all positions of the occurrences in the string <span class="arithmatex">$T$</span>.</p>
<p>Again we construct a suffix automaton for the text <span class="arithmatex">$T$</span>.
Similar as in the previous task we compute the position <span class="arithmatex">$firstpos$</span> for all states.</p>
<p>Clearly <span class="arithmatex">$firstpos(t)$</span> is part of the answer, if <span class="arithmatex">$t$</span> is the state corresponding to a query string <span class="arithmatex">$P$</span>.
So we took into account the state of the automaton containing <span class="arithmatex">$P$</span>.
What other states do we need to take into account?
All states that correspond to strings for which <span class="arithmatex">$P$</span> is a suffix.
In other words we need to find all the states that can reach the state <span class="arithmatex">$t$</span> via suffix links.</p>
<p>Therefore to solve the problem we need to save for each state a list of suffix references leading to it.
The answer to the query then will then contain all <span class="arithmatex">$firstpos$</span> for each state that we can find on a DFS / BFS starting from the state <span class="arithmatex">$t$</span> using only the suffix references.</p>
<p>Overall, this requires <span class="arithmatex">$O(length (T))$</span> for preprocessing and <span class="arithmatex">$O(length(P) + answer(P))$</span> for each request, where <span class="arithmatex">$answer(P)$</span>  this is the size of the answer.</p>
<p>First, we walk down the automaton for each character in the pattern to find our starting node requiring <span class="arithmatex">$O(length(P))$</span>.  Then, we use our workaround which will work in time <span class="arithmatex">$O(answer(P))$</span>, because we will not visit a state twice (because only one suffix link leaves each state, so there cannot be two different paths leading to the same state).</p>
<p>We only must take into account that two different states can have the same <span class="arithmatex">$firstpos$</span> value.
This happens if one state was obtained by cloning another.
However, this doesn't ruin the complexity, since each state can only have at most one clone.</p>
<p>Moreover, we can also get rid of the duplicate positions, if we don't output the positions from the cloned states.
In fact a state, that a cloned state can reach, is also reachable from the original state.
Thus if we remember the flag <code>is_cloned</code> for each state, we can simply ignore the cloned states and only output <span class="arithmatex">$firstpos$</span> for all other states.</p>
<p>Here are some implementation sketches:</p>
<div class="highlight"><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">state</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">is_clone</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">first_pos</span><span class="p">;</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">inv_link</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// after constructing the automaton</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sz</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">st</span><span class="p">[</span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">link</span><span class="p">].</span><span class="n">inv_link</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// output all positions of occurrences</span>
<span class="kt">void</span><span class="w"> </span><span class="n">output_all_occurrences</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">P_length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">is_clone</span><span class="p">)</span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">first_pos</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">P_length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">inv_link</span><span class="p">)</span>
<span class="w">        </span><span class="n">output_all_occurrences</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">P_length</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="shortest-non-appearing-string">Shortest non-appearing string<a class="headerlink" href="#shortest-non-appearing-string" title="Permanent link">&para;</a></h3>
<p>Given a string <span class="arithmatex">$S$</span> and a certain alphabet.
We have to find a string of the smallest length, that doesn't appear in <span class="arithmatex">$S$</span>.</p>
<p>We will apply dynamic programming on the suffix automaton built for the string <span class="arithmatex">$S$</span>.</p>
<p>Let <span class="arithmatex">$d[v]$</span> be the answer for the node <span class="arithmatex">$v$</span>, i.e. we already processed part of the substring, are currently in the state <span class="arithmatex">$v$</span>, and want to find the smallest number of characters that have to be added to find a non-existent transition.
Computing <span class="arithmatex">$d[v]$</span> is very simple.
If there is not transition using at least one character of the alphabet, then <span class="arithmatex">$d[v] = 1$</span>.
Otherwise one character is not enough, and so we need to take the minimum of all answers of all transitions:</p>
<div class="arithmatex">$$d[v] = 1 + \min_{w:(v,w,c) \in SA} d[w].$$</div>
<p>The answer to the problem will be <span class="arithmatex">$d[t_0]$</span>, and the actual string can be restored using the computed array <span class="arithmatex">$d[]$</span>.</p>
<h3 id="longest-common-substring-of-two-strings">Longest common substring of two strings<a class="headerlink" href="#longest-common-substring-of-two-strings" title="Permanent link">&para;</a></h3>
<p>Given two strings <span class="arithmatex">$S$</span> and <span class="arithmatex">$T$</span>.
We have to find the longest common substring, i.e. such a string <span class="arithmatex">$X$</span> that appears as a substring in <span class="arithmatex">$S$</span> and also in <span class="arithmatex">$T$</span>.</p>
<p>We construct a suffix automaton for the string <span class="arithmatex">$S$</span>.</p>
<p>We will now take the string <span class="arithmatex">$T$</span>, and for each prefix look for the longest suffix of this prefix in <span class="arithmatex">$S$</span>.
In other words, for each position in the string <span class="arithmatex">$T$</span>, we want to find the longest common substring of <span class="arithmatex">$S$</span> and <span class="arithmatex">$T$</span> ending in that position.</p>
<p>For this we will use two variables, the <strong>current state</strong> <span class="arithmatex">$v$</span>, and the <strong>current length</strong> <span class="arithmatex">$l$</span>.
These two variables will describe the current matching part: its length and the state that corresponds to it.</p>
<p>Initially <span class="arithmatex">$v = t_0$</span> and <span class="arithmatex">$l = 0$</span>, i.e. the match is empty.</p>
<p>Now let us describe how we can add a character <span class="arithmatex">$T[i]$</span> and recalculate the answer for it.</p>
<ul>
<li>If there is a transition from <span class="arithmatex">$v$</span> with the character <span class="arithmatex">$T[i]$</span>, then we simply follow the transition and increase <span class="arithmatex">$l$</span> by one.</li>
<li>If there is no such transition, we have to shorten the current matching part, which means that we need to follow the suffix link: <span class="arithmatex">$v = link(v)$</span>.
    At the same time, the current length has to be shortened.
    Obviously we need to assign <span class="arithmatex">$l = len(v)$</span>, since after passing through the suffix link we end up in state whose corresponding longest string is a substring.</li>
<li>If there is still no transition using the required character, we repeat and again go through the suffix link and decrease <span class="arithmatex">$l$</span>, until we find a transition or we reach the fictional state <span class="arithmatex">$-1$</span> (which means that the symbol <span class="arithmatex">$T[i]$</span> doesn't appear at all in <span class="arithmatex">$S$</span>, so we assign <span class="arithmatex">$v = l = 0$</span>).</li>
</ul>
<p>The answer to the task will be the maximum of all the values <span class="arithmatex">$l$</span>.</p>
<p>The complexity of this part is <span class="arithmatex">$O(length(T))$</span>, since in one move we can either increase <span class="arithmatex">$l$</span> by one, or make several passes through the suffix links, each one ends up reducing the value <span class="arithmatex">$l$</span>.</p>
<p>Implementation:</p>
<div class="highlight"><pre><span></span><code><span class="n">string</span><span class="w"> </span><span class="nf">lcs</span><span class="w"> </span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sa_init</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">S</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">sa_extend</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bestpos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">next</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">link</span><span class="w"> </span><span class="p">;</span>
<span class="w">            </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">len</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">next</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">next</span><span class="p">[</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
<span class="w">            </span><span class="n">l</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">best</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">best</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">;</span>
<span class="w">            </span><span class="n">bestpos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">bestpos</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">best</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div>
<h3 id="largest-common-substring-of-multiple-strings">Largest common substring of multiple strings<a class="headerlink" href="#largest-common-substring-of-multiple-strings" title="Permanent link">&para;</a></h3>
<p>There are <span class="arithmatex">$k$</span> strings <span class="arithmatex">$S_i$</span> given.
We have to find the longest common substring, i.e. such a string <span class="arithmatex">$X$</span> that appears as substring in each string <span class="arithmatex">$S_i$</span>.</p>
<p>We join all strings into one large string <span class="arithmatex">$T$</span>, separating the strings by a special characters <span class="arithmatex">$D_i$</span> (one for each string):</p>
<div class="arithmatex">$$T = S_1 + D_1 + S_2 + D_2 + \dots + S_k + D_k.$$</div>
<p>Then we construct the suffix automaton for the string <span class="arithmatex">$T$</span>.</p>
<p>Now we need to find a string in the machine, which is contained in all the strings <span class="arithmatex">$S_i$</span>, and this can be done by using the special added characters.
Note that if a substring is included in some string <span class="arithmatex">$S_j$</span>, then in the suffix automaton exists a path starting from this substring containing the character <span class="arithmatex">$D_j$</span> and not containing the other characters <span class="arithmatex">$D_1, \dots, D_{j-1}, D_{j+1}, \dots, D_k$</span>.</p>
<p>Thus we need to calculate the attainability, which tells us for each state of the machine and each symbol <span class="arithmatex">$D_i$</span> if there exists such a path.
This can easily be computed by DFS or BFS and dynamic programming.
After that, the answer to the problem will be the string <span class="arithmatex">$longest(v)$</span> for the state <span class="arithmatex">$v$</span>, from which the paths were exists for all special characters.</p>
<h2 id="practice-problems">Practice Problems<a class="headerlink" href="#practice-problems" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://cses.fi/problemset/task/2102">CSES - Finding Patterns</a></li>
<li><a href="https://cses.fi/problemset/task/2103">CSES - Counting Patterns</a></li>
<li><a href="https://cses.fi/problemset/task/1753">CSES - String Matching</a></li>
<li><a href="https://cses.fi/problemset/task/2104">CSES - Patterns Positions</a></li>
<li><a href="https://cses.fi/problemset/task/2105">CSES - Distinct Substrings</a></li>
<li><a href="https://cses.fi/problemset/task/1731">CSES - Word Combinations</a></li>
<li><a href="https://cses.fi/problemset/task/2110">CSES - String Distribution</a></li>
<li><a href="https://atcoder.jp/contests/abc097/tasks/arc097_a">AtCoder - K-th Substring</a></li>
<li><a href="https://www.spoj.com/problems/SUBLEX/">SPOJ - SUBLEX</a></li>
<li><a href="https://codeforces.com/problemset/problem/235/C">Codeforces - Cyclical Quest</a></li>
<li><a href="https://codeforces.com/contest/128/problem/B">Codeforces - String</a></li>
</ul>

<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
  <span class="contributors-text">Contributors:</span>
  <ul class="contributors" data-bi-name="contributors"><li><a href="https://github.com/jakobkogler" title="jakobkogler" data-bi-name="contributorprofile" target="_blank">jakobkogler</a> (89.12%)</li><li><a href="https://github.com/mhayter" title="mhayter" data-bi-name="contributorprofile" target="_blank">mhayter</a> (4.81%)</li><li><a href="https://github.com/AtharvaThorve" title="AtharvaThorve" data-bi-name="contributorprofile" target="_blank">AtharvaThorve</a> (1.9%)</li><li><a href="https://github.com/iagorrr" title="iagorrr" data-bi-name="contributorprofile" target="_blank">iagorrr</a> (0.89%)</li><li><a href="https://github.com/adamant-pwn" title="adamant-pwn" data-bi-name="contributorprofile" target="_blank">adamant-pwn</a> (0.89%)</li><li><a href="https://github.com/roll-no-1" title="roll-no-1" data-bi-name="contributorprofile" target="_blank">roll-no-1</a> (0.76%)</li><li><a href="https://github.com/wilsjame" title="wilsjame" data-bi-name="contributorprofile" target="_blank">wilsjame</a> (0.63%)</li><li><a href="https://github.com/Ir1d" title="Ir1d" data-bi-name="contributorprofile" target="_blank">Ir1d</a> (0.25%)</li><li><a href="https://github.com/abeaumont" title="abeaumont" data-bi-name="contributorprofile" target="_blank">abeaumont</a> (0.13%)</li><li><a href="https://github.com/rohaquinlop" title="rohaquinlop" data-bi-name="contributorprofile" target="_blank">rohaquinlop</a> (0.13%)</li><li><a href="https://github.com/Kakalinn" title="Kakalinn" data-bi-name="contributorprofile" target="_blank">Kakalinn</a> (0.13%)</li><li><a href="https://github.com/hieplpvip" title="hieplpvip" data-bi-name="contributorprofile" target="_blank">hieplpvip</a> (0.13%)</li><li><a href="https://github.com/wikku" title="wikku" data-bi-name="contributorprofile" target="_blank">wikku</a> (0.13%)</li><li><a href="https://github.com/NAbdulla1" title="NAbdulla1" data-bi-name="contributorprofile" target="_blank">NAbdulla1</a> (0.13%)</li></ul>
</ul>
                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      

<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Text is available under the <a href="https://github.com/cp-algorithms/cp-algorithms/blob/main/LICENSE">Creative Commons Attribution Share Alike 4.0 International</a> License<br/>Copyright &copy; 2014 - 2025 by <a href="https://github.com/cp-algorithms/cp-algorithms/graphs/contributors">cp-algorithms contributors</a>
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      <div class="md-social">
  
</div>
    </div>
  </div>
</footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "search.suggest", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../javascript/config.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../assets/javascripts/toggle-sidebar.js" async></script>
      
    
  </body>
</html>